/*!
 * rpg_windows.js - v1.6.1 (community-1.4)
 * (c) 2015 KADOKAWA CORPORATION./YOJI OJIMA
 * Contributions by the RPG Maker MV CoreScript team
 * https://github.com/thinknathan/corescript/blob/master/CONTRIBUTORS.md
 *
 * Licensed under the MIT License.
 * https://github.com/thinknathan/corescript/blob/master/LICENSE
 */
"use strict"
function Window_Base(){this.initialize.apply(this,arguments)}function Window_Selectable(){this.initialize.apply(this,arguments)}function Window_Command(){this.initialize.apply(this,arguments)}function Window_HorzCommand(){this.initialize.apply(this,arguments)}function Window_Help(){this.initialize.apply(this,arguments)}function Window_Gold(){this.initialize.apply(this,arguments)}function Window_MenuCommand(){this.initialize.apply(this,arguments)}function Window_MenuStatus(){this.initialize.apply(this,arguments)}function Window_MenuActor(){this.initialize.apply(this,arguments)}function Window_ItemCategory(){this.initialize.apply(this,arguments)}function Window_ItemList(){this.initialize.apply(this,arguments)}function Window_SkillType(){this.initialize.apply(this,arguments)}function Window_SkillStatus(){this.initialize.apply(this,arguments)}function Window_SkillList(){this.initialize.apply(this,arguments)}function Window_EquipStatus(){this.initialize.apply(this,arguments)}function Window_EquipCommand(){this.initialize.apply(this,arguments)}function Window_EquipSlot(){this.initialize.apply(this,arguments)}function Window_EquipItem(){this.initialize.apply(this,arguments)}function Window_Status(){this.initialize.apply(this,arguments)}function Window_Options(){this.initialize.apply(this,arguments)}function Window_SavefileList(){this.initialize.apply(this,arguments)}function Window_ShopCommand(){this.initialize.apply(this,arguments)}function Window_ShopBuy(){this.initialize.apply(this,arguments)}function Window_ShopSell(){this.initialize.apply(this,arguments)}function Window_ShopNumber(){this.initialize.apply(this,arguments)}function Window_ShopStatus(){this.initialize.apply(this,arguments)}function Window_NameEdit(){this.initialize.apply(this,arguments)}function Window_NameInput(){this.initialize.apply(this,arguments)}function Window_ChoiceList(){this.initialize.apply(this,arguments)}function Window_NumberInput(){this.initialize.apply(this,arguments)}function Window_EventItem(){this.initialize.apply(this,arguments)}function Window_Message(){this.initialize.apply(this,arguments)}function Window_ScrollText(){this.initialize.apply(this,arguments)}function Window_MapName(){this.initialize.apply(this,arguments)}function Window_BattleLog(){this.initialize.apply(this,arguments)}function Window_PartyCommand(){this.initialize.apply(this,arguments)}function Window_ActorCommand(){this.initialize.apply(this,arguments)}function Window_BattleStatus(){this.initialize.apply(this,arguments)}function Window_BattleActor(){this.initialize.apply(this,arguments)}function Window_BattleEnemy(){this.initialize.apply(this,arguments)}function Window_BattleSkill(){this.initialize.apply(this,arguments)}function Window_BattleItem(){this.initialize.apply(this,arguments)}function Window_TitleCommand(){this.initialize.apply(this,arguments)}function Window_GameEnd(){this.initialize.apply(this,arguments)}function Window_DebugRange(){this.initialize.apply(this,arguments)}function Window_DebugEdit(){this.initialize.apply(this,arguments)}Window_Base.prototype=Object.create(Window.prototype),Window_Base.prototype.constructor=Window_Base,Window_Base.prototype.initialize=function(t,e,i,o){Window.prototype.initialize.call(this),this.loadWindowskin(),this.move(t,e,i,o),this.updatePadding(),this.updateBackOpacity(),this.updateTone(),this.createContents(),this._opening=!1,this._closing=!1,this._dimmerSprite=null},Window_Base._iconWidth=32,Window_Base._iconHeight=32,Window_Base._faceWidth=144,Window_Base._faceHeight=144,Window_Base.prototype.lineHeight=function(){return 36},Window_Base.prototype.standardFontFace=function(){return $gameSystem.isChinese()?"SimHei, Heiti TC, sans-serif":$gameSystem.isKorean()?"Dotum, AppleGothic, sans-serif":"GameFont"},Window_Base.prototype.standardFontSize=function(){return 28},Window_Base.prototype.standardPadding=function(){return 18},Window_Base.prototype.textPadding=function(){return 6},Window_Base.prototype.standardBackOpacity=function(){return 192},Window_Base.prototype.loadWindowskin=function(){this.windowskin=ImageManager.loadSystem("Window")},Window_Base.prototype.updatePadding=function(){this.padding=this.standardPadding()},Window_Base.prototype.updateBackOpacity=function(){this.backOpacity=this.standardBackOpacity()},Window_Base.prototype.contentsWidth=function(){return this.width-2*this.standardPadding()},Window_Base.prototype.contentsHeight=function(){return this.height-2*this.standardPadding()},Window_Base.prototype.fittingHeight=function(t){return t*this.lineHeight()+2*this.standardPadding()},Window_Base.prototype.updateTone=function(){const t=$gameSystem.windowTone()
this.setTone(t[0],t[1],t[2])},Window_Base.prototype.createContents=function(){this.contents?this.contents.clear():(this.contents=new BitmapPIXI(this.contentsWidth(),this.contentsHeight()),this._windowContentsSprite.addChild(this.contents)),this.resetFontSettings()},Window_Base.prototype.resetFontSettings=function(){this.contents.fontFace=this.standardFontFace(),this.contents.fontSize=this.standardFontSize(),this.resetTextColor()},Window_Base.prototype.resetTextColor=function(){this.changeTextColor(this.normalColor())},Window_Base.prototype.update=function(){Window.prototype.update.call(this),this.updateTone(),this.updateOpen(),this.updateClose(),this.updateBackgroundDimmer()},Window_Base.prototype.updateOpen=function(){this._opening&&(this.openness+=32,this.isOpen()&&(this._opening=!1))},Window_Base.prototype.updateClose=function(){this._closing&&(this.openness-=32,this.isClosed()&&(this._closing=!1))},Window_Base.prototype.open=function(){this.isOpen()||(this._opening=!0),this._closing=!1},Window_Base.prototype.close=function(){this.isClosed()||(this._closing=!0),this._opening=!1},Window_Base.prototype.isOpening=function(){return this._opening},Window_Base.prototype.isClosing=function(){return this._closing},Window_Base.prototype.show=function(){this.visible=!0},Window_Base.prototype.hide=function(){this.visible=!1},Window_Base.prototype.activate=function(){this.active=!0},Window_Base.prototype.deactivate=function(){this.active=!1},Window_Base.prototype.textColor=function(t){const e=102+t%8*12,i=150+12*Math.floor(t/8)
return this.windowskin.getPixel(e,i)},Window_Base.prototype.normalColor=function(){return this.textColor(0)},Window_Base.prototype.systemColor=function(){return this.textColor(16)},Window_Base.prototype.crisisColor=function(){return this.textColor(17)},Window_Base.prototype.deathColor=function(){return this.textColor(18)},Window_Base.prototype.gaugeBackColor=function(){return this.textColor(19)},Window_Base.prototype.hpGaugeColor1=function(){return this.textColor(20)},Window_Base.prototype.hpGaugeColor2=function(){return this.textColor(21)},Window_Base.prototype.mpGaugeColor1=function(){return this.textColor(22)},Window_Base.prototype.mpGaugeColor2=function(){return this.textColor(23)},Window_Base.prototype.mpCostColor=function(){return this.textColor(23)},Window_Base.prototype.powerUpColor=function(){return this.textColor(24)},Window_Base.prototype.powerDownColor=function(){return this.textColor(25)},Window_Base.prototype.tpGaugeColor1=function(){return this.textColor(28)},Window_Base.prototype.tpGaugeColor2=function(){return this.textColor(29)},Window_Base.prototype.tpCostColor=function(){return this.textColor(29)},Window_Base.prototype.pendingColor=function(){return this.windowskin.getPixel(120,120)},Window_Base.prototype.translucentOpacity=function(){return 160},Window_Base.prototype.changeTextColor=function(t){this.contents.textColor=t},Window_Base.prototype.changePaintOpacity=function(t){this.contents.paintOpacity=t?255:this.translucentOpacity()},Window_Base.prototype.drawText=function(t,e,i,o,n){this.contents.drawText(t,e,i,o,this.lineHeight(),n)},Window_Base.prototype.textWidth=function(t){return this.contents.measureTextWidth(t)},Window_Base.prototype.drawTextEx=function(t,e,i){if(t){const o={index:0,x:e,y:i,left:e}
for(o.text=this.convertEscapeCharacters(t),o.height=this.calcTextHeight(o,!1),this.resetFontSettings();o.index<o.text.length;)this.processCharacter(o)
return o.x-e}return 0},Window_Base.prototype.convertEscapeCharacters=function(t){return t=(t=(t=t.replace(/\\/g,"")).replace(/\x1b\x1b/g,"\\")).replace(/\x1bV\[(\d+)\]/gi,function(){return $gameVariables.value(parseInt(arguments[1]))}.bind(this)),t=t.replace(/\x1bV\[(\d+)\]/gi,function(){return $gameVariables.value(parseInt(arguments[1]))}.bind(this)),t=t.replace(/\x1bN\[(\d+)\]/gi,function(){return this.actorName(parseInt(arguments[1]))}.bind(this)),t=t.replace(/\x1bP\[(\d+)\]/gi,function(){return this.partyMemberName(parseInt(arguments[1]))}.bind(this)),t.replace(/\x1bG/gi,TextManager.currencyUnit)},Window_Base.prototype.actorName=function(t){const e=t>=1?$gameActors.actor(t):null
return e?e.name():""},Window_Base.prototype.partyMemberName=function(t){const e=t>=1?$gameParty.members()[t-1]:null
return e?e.name():""},Window_Base.prototype.processCharacter=function(t){switch(t.text[t.index]){case"\n":this.processNewLine(t)
break
case"\f":this.processNewPage(t)
break
case"":this.processEscapeCharacter(this.obtainEscapeCode(t),t)
break
default:this.processNormalCharacter(t)}},Window_Base.prototype.processNormalCharacter=function(t){const e=t.text[t.index++],i=this.textWidth(e)
this.contents.drawText(e,t.x,t.y,2*i,t.height),t.x+=i},Window_Base.prototype.processNewLine=function(t){t.x=t.left,t.y+=t.height,t.height=this.calcTextHeight(t,!1),t.index++},Window_Base.prototype.processNewPage=function(t){t.index++},Window_Base.prototype.obtainEscapeCode=function(t){t.index++
const e=void 0,i=/^[\$\.\|\^!><\{\}\\]|^[A-Z]+/i.exec(t.text.slice(t.index))
return i?(t.index+=i[0].length,i[0].toUpperCase()):""},Window_Base.prototype.obtainEscapeParam=function(t){const e=/^\[\d+\]/.exec(t.text.slice(t.index))
return e?(t.index+=e[0].length,parseInt(e[0].slice(1))):""},Window_Base.prototype.processEscapeCharacter=function(t,e){switch(t){case"C":this.changeTextColor(this.textColor(this.obtainEscapeParam(e)))
break
case"I":this.processDrawIcon(this.obtainEscapeParam(e),e)
break
case"{":this.makeFontBigger()
break
case"}":this.makeFontSmaller()}},Window_Base.prototype.processDrawIcon=function(t,e){this.drawIcon(t,e.x+2,e.y+2),e.x+=Window_Base._iconWidth+4},Window_Base.prototype.makeFontBigger=function(){this.contents.fontSize<=96&&(this.contents.fontSize+=12)},Window_Base.prototype.makeFontSmaller=function(){this.contents.fontSize>=24&&(this.contents.fontSize-=12)},Window_Base.prototype.calcTextHeight=function(t,e){const i=this.contents.fontSize
let o=0
const n=t.text.slice(t.index).split("\n"),s=e?n.length:1
for(let t=0;t<s;t++){let e=this.contents.fontSize
const i=/\x1b[\{\}]/g
for(;;){const o=i.exec(n[t])
if(!o)break
"{"===o[0]&&this.makeFontBigger(),"}"===o[0]&&this.makeFontSmaller(),e<this.contents.fontSize&&(e=this.contents.fontSize)}o+=e+8}return this.contents.fontSize=i,o},Window_Base.prototype.drawIcon=function(t,e,i){const o=ImageManager.loadSystem("IconSet"),n=Window_Base._iconWidth,s=Window_Base._iconHeight,a=t%16*n,r=Math.floor(t/16)*s
this.contents.blt(o,a,r,n,s,e,i)},Window_Base.prototype.drawFace=function(t,e,i,o,n,s){n=n||Window_Base._faceWidth,s=s||Window_Base._faceHeight
const a=ImageManager.loadFace(t),r=Window_Base._faceWidth,p=Window_Base._faceHeight,h=Math.min(n,r),d=Math.min(s,p),c=Math.floor(i+Math.max(n-r,0)/2),u=Math.floor(o+Math.max(s-p,0)/2),l=e%4*r+(r-h)/2,m=Math.floor(e/4)*p+(p-d)/2
this.contents.blt(a,l,m,h,d,c,u)},Window_Base.prototype.drawCharacter=function(t,e,i,o){const n=ImageManager.loadCharacter(t),s=ImageManager.isBigCharacter(t),a=n.width/(s?3:12),r=n.height/(s?4:8),p=s?0:e,h=(p%4*3+1)*a,d=4*Math.floor(p/4)*r
this.contents.blt(n,h,d,a,r,i-a/2,o-r)},Window_Base.prototype.drawGauge=function(t,e,i,o,n,s){const a=Math.floor(i*o),r=e+this.lineHeight()-8
this.contents.fillRect(t,r,i,6,this.gaugeBackColor()),this.contents.gradientFillRect(t,r,a,6,n,s)},Window_Base.prototype.hpColor=function(t){return t.isDead()?this.deathColor():t.isDying()?this.crisisColor():this.normalColor()},Window_Base.prototype.mpColor=function(t){return this.normalColor()},Window_Base.prototype.tpColor=function(t){return this.normalColor()},Window_Base.prototype.drawActorCharacter=function(t,e,i){this.drawCharacter(t.characterName(),t.characterIndex(),e,i)},Window_Base.prototype.drawActorFace=function(t,e,i,o,n){this.drawFace(t.faceName(),t.faceIndex(),e,i,o,n)},Window_Base.prototype.drawActorName=function(t,e,i,o){o=o||168,this.changeTextColor(this.hpColor(t)),this.drawText(t.name(),e,i,o)},Window_Base.prototype.drawActorClass=function(t,e,i,o){o=o||168,this.resetTextColor(),this.drawText(t.currentClass().name,e,i,o)},Window_Base.prototype.drawActorNickname=function(t,e,i,o){o=o||270,this.resetTextColor(),this.drawText(t.nickname(),e,i,o)},Window_Base.prototype.drawActorLevel=function(t,e,i){this.changeTextColor(this.systemColor()),this.drawText(TextManager.levelA,e,i,48),this.resetTextColor(),this.drawText(t.level,e+84,i,36,"right")},Window_Base.prototype.drawActorIcons=function(t,e,i,o){o=o||144
const n=t.allIcons().slice(0,Math.floor(o/Window_Base._iconWidth))
for(let t=0;t<n.length;t++)this.drawIcon(n[t],e+Window_Base._iconWidth*t,i+2)},Window_Base.prototype.drawCurrentAndMax=function(t,e,i,o,n,s,a){const r=this.textWidth("HP"),p=this.textWidth("0000"),h=this.textWidth("/"),d=i+n-p,c=d-h,u=c-p
u>=i+r?(this.changeTextColor(s),this.drawText(t,u,o,p,"right"),this.changeTextColor(a),this.drawText("/",c,o,h,"right"),this.drawText(e,d,o,p,"right")):(this.changeTextColor(s),this.drawText(t,d,o,p,"right"))},Window_Base.prototype.drawActorHp=function(t,e,i,o){o=o||186
const n=this.hpGaugeColor1(),s=this.hpGaugeColor2()
this.drawGauge(e,i,o,t.hpRate(),n,s),this.changeTextColor(this.systemColor()),this.drawText(TextManager.hpA,e,i,44),this.drawCurrentAndMax(t.hp,t.mhp,e,i,o,this.hpColor(t),this.normalColor())},Window_Base.prototype.drawActorMp=function(t,e,i,o){o=o||186
const n=this.mpGaugeColor1(),s=this.mpGaugeColor2()
this.drawGauge(e,i,o,t.mpRate(),n,s),this.changeTextColor(this.systemColor()),this.drawText(TextManager.mpA,e,i,44),this.drawCurrentAndMax(t.mp,t.mmp,e,i,o,this.mpColor(t),this.normalColor())},Window_Base.prototype.drawActorTp=function(t,e,i,o){o=o||96
const n=this.tpGaugeColor1(),s=this.tpGaugeColor2()
this.drawGauge(e,i,o,t.tpRate(),n,s),this.changeTextColor(this.systemColor()),this.drawText(TextManager.tpA,e,i,44),this.changeTextColor(this.tpColor(t)),this.drawText(t.tp,e+o-64,i,64,"right")},Window_Base.prototype.drawActorSimpleStatus=function(t,e,i,o){const n=this.lineHeight(),s=e+180,a=Math.min(200,o-180-this.textPadding())
this.drawActorName(t,e,i),this.drawActorLevel(t,e,i+1*n),this.drawActorIcons(t,e,i+2*n),this.drawActorClass(t,s,i),this.drawActorHp(t,s,i+1*n,a),this.drawActorMp(t,s,i+2*n,a)},Window_Base.prototype.drawItemName=function(t,e,i,o){if(o=o||312,t){const n=Window_Base._iconWidth+4
this.resetTextColor(),this.drawIcon(t.iconIndex,e+2,i+2),this.drawText(t.name,e+n,i,o-n)}},Window_Base.prototype.drawCurrencyValue=function(t,e,i,o,n){const s=Math.min(80,this.textWidth(e))
this.resetTextColor(),this.drawText(t,i,o,n-s-6,"right"),this.changeTextColor(this.systemColor()),this.drawText(e,i+n-s,o,s,"right")},Window_Base.prototype.paramchangeTextColor=function(t){return t>0?this.powerUpColor():t<0?this.powerDownColor():this.normalColor()},Window_Base.prototype.setBackgroundType=function(t){this.opacity=0===t?255:0,1===t?this.showBackgroundDimmer():this.hideBackgroundDimmer()},Window_Base.prototype.showBackgroundDimmer=function(){this._dimmerSprite||(this._dimmerSprite=new Sprite,this._dimmerSprite.bitmap=new Bitmap(0,0),this.addChildToBack(this._dimmerSprite))
const t=this._dimmerSprite.bitmap
t.width===this.width&&t.height===this.height||this.refreshDimmerBitmap(),this._dimmerSprite.visible=!0,this.updateBackgroundDimmer()},Window_Base.prototype.hideBackgroundDimmer=function(){this._dimmerSprite&&(this._dimmerSprite.visible=!1)},Window_Base.prototype.updateBackgroundDimmer=function(){this._dimmerSprite&&(this._dimmerSprite.opacity=this.openness)},Window_Base.prototype.refreshDimmerBitmap=function(){if(this._dimmerSprite){const t=this._dimmerSprite.bitmap,e=this.width,i=this.height,o=this.padding,n=this.dimColor1(),s=this.dimColor2()
t.resize(e,i),t.gradientFillRect(0,0,e,o,s,n,!0),t.fillRect(0,o,e,i-2*o,n),t.gradientFillRect(0,i-o,e,o,n,s,!0),this._dimmerSprite.setFrame(0,0,e,i)}},Window_Base.prototype.dimColor1=function(){return"rgba(0, 0, 0, 0.6)"},Window_Base.prototype.dimColor2=function(){return"rgba(0, 0, 0, 0)"},Window_Base.prototype.canvasToLocalX=function(t){let e=this
for(;e;)t-=e.x,e=e.parent
return t},Window_Base.prototype.canvasToLocalY=function(t){let e=this
for(;e;)t-=e.y,e=e.parent
return t},Window_Base.prototype.reserveFaceImages=function(){$gameParty.members().forEach((function(t){ImageManager.reserveFace(t.faceName())}),this)},Window_Selectable.prototype=Object.create(Window_Base.prototype),Window_Selectable.prototype.constructor=Window_Selectable,Window_Selectable.prototype.initialize=function(t,e,i,o){Window_Base.prototype.initialize.call(this,t,e,i,o),this._index=-1,this._cursorFixed=!1,this._cursorAll=!1,this._stayCount=0,this._helpWindow=null,this._handlers={},this._touching=!1,this._scrollX=0,this._scrollY=0,this.deactivate()},Window_Selectable.prototype.index=function(){return this._index},Window_Selectable.prototype.cursorFixed=function(){return this._cursorFixed},Window_Selectable.prototype.setCursorFixed=function(t){this._cursorFixed=t},Window_Selectable.prototype.cursorAll=function(){return this._cursorAll},Window_Selectable.prototype.setCursorAll=function(t){this._cursorAll=t},Window_Selectable.prototype.maxCols=function(){return 1},Window_Selectable.prototype.maxItems=function(){return 0},Window_Selectable.prototype.spacing=function(){return 12},Window_Selectable.prototype.itemWidth=function(){return Math.floor((this.width-2*this.padding+this.spacing())/this.maxCols()-this.spacing())},Window_Selectable.prototype.itemHeight=function(){return this.lineHeight()},Window_Selectable.prototype.maxRows=function(){return Math.max(Math.ceil(this.maxItems()/this.maxCols()),1)},Window_Selectable.prototype.activate=function(){Window_Base.prototype.activate.call(this),this.reselect()},Window_Selectable.prototype.deactivate=function(){Window_Base.prototype.deactivate.call(this),this.reselect()},Window_Selectable.prototype.select=function(t){this._index=t,this._stayCount=0,this.ensureCursorVisible(),this.updateCursor(),this.callUpdateHelp()},Window_Selectable.prototype.deselect=function(){this.select(-1)},Window_Selectable.prototype.reselect=function(){this.select(this._index)},Window_Selectable.prototype.row=function(){return Math.floor(this.index()/this.maxCols())},Window_Selectable.prototype.topRow=function(){return Math.floor(this._scrollY/this.itemHeight())},Window_Selectable.prototype.maxTopRow=function(){return Math.max(0,this.maxRows()-this.maxPageRows())},Window_Selectable.prototype.setTopRow=function(t){const e=t.clamp(0,this.maxTopRow())*this.itemHeight()
this._scrollY!==e&&(this._scrollY=e,this.refresh(),this.updateCursor())},Window_Selectable.prototype.resetScroll=function(){this.setTopRow(0)},Window_Selectable.prototype.maxPageRows=function(){const t=this.height-2*this.padding
return Math.floor(t/this.itemHeight())},Window_Selectable.prototype.maxPageItems=function(){return this.maxPageRows()*this.maxCols()},Window_Selectable.prototype.isHorizontal=function(){return 1===this.maxPageRows()},Window_Selectable.prototype.bottomRow=function(){return Math.max(0,this.topRow()+this.maxPageRows()-1)},Window_Selectable.prototype.setBottomRow=function(t){this.setTopRow(t-(this.maxPageRows()-1))},Window_Selectable.prototype.topIndex=function(){return this.topRow()*this.maxCols()},Window_Selectable.prototype.itemRect=function(t){const e=new Rectangle,i=this.maxCols()
return e.width=this.itemWidth(),e.height=this.itemHeight(),e.x=t%i*(e.width+this.spacing())-this._scrollX,e.y=Math.floor(t/i)*e.height-this._scrollY,e},Window_Selectable.prototype.itemRectForText=function(t){const e=this.itemRect(t)
return e.x+=this.textPadding(),e.width-=2*this.textPadding(),e},Window_Selectable.prototype.setHelpWindow=function(t){this._helpWindow=t,this.callUpdateHelp()},Window_Selectable.prototype.showHelpWindow=function(){this._helpWindow&&this._helpWindow.show()},Window_Selectable.prototype.hideHelpWindow=function(){this._helpWindow&&this._helpWindow.hide()},Window_Selectable.prototype.setHandler=function(t,e){this._handlers[t]=e},Window_Selectable.prototype.isHandled=function(t){return!!this._handlers[t]},Window_Selectable.prototype.callHandler=function(t){this.isHandled(t)&&this._handlers[t]()},Window_Selectable.prototype.isOpenAndActive=function(){return this.isOpen()&&this.active},Window_Selectable.prototype.isCursorMovable=function(){return this.isOpenAndActive()&&!this._cursorFixed&&!this._cursorAll&&this.maxItems()>0},Window_Selectable.prototype.cursorDown=function(t){const e=this.index(),i=this.maxItems(),o=this.maxCols();(e<i-o||t&&1===o)&&this.select((e+o)%i)},Window_Selectable.prototype.cursorUp=function(t){const e=this.index(),i=this.maxItems(),o=this.maxCols();(e>=o||t&&1===o)&&this.select((e-o+i)%i)},Window_Selectable.prototype.cursorRight=function(t){const e=this.index(),i=this.maxItems(),o=void 0
this.maxCols()>=2&&(e<i-1||t&&this.isHorizontal())&&this.select((e+1)%i)},Window_Selectable.prototype.cursorLeft=function(t){const e=this.index(),i=this.maxItems(),o=void 0
this.maxCols()>=2&&(e>0||t&&this.isHorizontal())&&this.select((e-1+i)%i)},Window_Selectable.prototype.cursorPagedown=function(){const t=this.index(),e=this.maxItems()
this.topRow()+this.maxPageRows()<this.maxRows()&&(this.setTopRow(this.topRow()+this.maxPageRows()),this.select(Math.min(t+this.maxPageItems(),e-1)))},Window_Selectable.prototype.cursorPageup=function(){const t=this.index()
this.topRow()>0&&(this.setTopRow(this.topRow()-this.maxPageRows()),this.select(Math.max(t-this.maxPageItems(),0)))},Window_Selectable.prototype.scrollDown=function(){this.topRow()+1<this.maxRows()&&this.setTopRow(this.topRow()+1)},Window_Selectable.prototype.scrollUp=function(){this.topRow()>0&&this.setTopRow(this.topRow()-1)},Window_Selectable.prototype.update=function(){Window_Base.prototype.update.call(this),this.updateArrows(),this.processCursorMove(),this.processHandling(),this.processWheel(),this.processTouch(),this._stayCount++},Window_Selectable.prototype.updateArrows=function(){const t=this.topRow(),e=this.maxTopRow()
this.downArrowVisible=e>0&&t<e,this.upArrowVisible=t>0},Window_Selectable.prototype.processCursorMove=function(){if(this.isCursorMovable()){const t=this.index()
Input.isRepeated("down")&&this.cursorDown(Input.isTriggered("down")),Input.isRepeated("up")&&this.cursorUp(Input.isTriggered("up")),Input.isRepeated("right")&&this.cursorRight(Input.isTriggered("right")),Input.isRepeated("left")&&this.cursorLeft(Input.isTriggered("left")),!this.isHandled("pagedown")&&Input.isTriggered("pagedown")&&this.cursorPagedown(),!this.isHandled("pageup")&&Input.isTriggered("pageup")&&this.cursorPageup(),this.index()!==t&&SoundManager.playCursor()}},Window_Selectable.prototype.processHandling=function(){this.isOpenAndActive()&&(this.isOkEnabled()&&this.isOkTriggered()?this.processOk():this.isCancelEnabled()&&this.isCancelTriggered()?this.processCancel():this.isHandled("pagedown")&&Input.isTriggered("pagedown")?this.processPagedown():this.isHandled("pageup")&&Input.isTriggered("pageup")&&this.processPageup())},Window_Selectable.prototype.processWheel=function(){if(this.isOpenAndActive()){const t=20
TouchInput.wheelY>=t&&this.scrollDown(),TouchInput.wheelY<=-t&&this.scrollUp()}},Window_Selectable.prototype.processTouch=function(){this.isOpenAndActive()?(TouchInput.isTriggered()&&this.isTouchedInsideFrame()?(this._touching=!0,this.onTouch(!0)):TouchInput.isCancelled()&&this.isCancelEnabled()&&this.processCancel(),this._touching&&(TouchInput.isPressed()?this.onTouch(!1):this._touching=!1)):this._touching=!1},Window_Selectable.prototype.isTouchedInsideFrame=function(){const t=this.canvasToLocalX(TouchInput.x),e=this.canvasToLocalY(TouchInput.y)
return t>=0&&e>=0&&t<this.width&&e<this.height},Window_Selectable.prototype.onTouch=function(t){const e=this.index(),i=this.canvasToLocalX(TouchInput.x),o=this.canvasToLocalY(TouchInput.y),n=this.hitTest(i,o)
n>=0?n===this.index()?t&&this.isTouchOkEnabled()&&this.processOk():this.isCursorMovable()&&this.select(n):this._stayCount>=10&&(o<this.padding?this.cursorUp():o>=this.height-this.padding&&this.cursorDown()),this.index()!==e&&SoundManager.playCursor()},Window_Selectable.prototype.hitTest=function(t,e){if(this.isContentsArea(t,e)){const i=t-this.padding,o=e-this.padding,n=this.topIndex()
for(let t=0;t<this.maxPageItems();t++){const e=n+t
if(e<this.maxItems()){const t=this.itemRect(e),n=t.x+t.width,s=t.y+t.height
if(i>=t.x&&o>=t.y&&i<n&&o<s)return e}}}return-1},Window_Selectable.prototype.isContentsArea=function(t,e){const i=this.padding,o=this.padding,n=this.width-this.padding,s=this.height-this.padding
return t>=i&&e>=o&&t<n&&e<s},Window_Selectable.prototype.isTouchOkEnabled=function(){return this.isOkEnabled()},Window_Selectable.prototype.isOkEnabled=function(){return this.isHandled("ok")},Window_Selectable.prototype.isCancelEnabled=function(){return this.isHandled("cancel")},Window_Selectable.prototype.isOkTriggered=function(){return Input.isRepeated("ok")},Window_Selectable.prototype.isCancelTriggered=function(){return Input.isRepeated("cancel")},Window_Selectable.prototype.processOk=function(){this.isCurrentItemEnabled()?(this.playOkSound(),this.updateInputData(),this.deactivate(),this.callOkHandler()):this.playBuzzerSound()},Window_Selectable.prototype.playOkSound=function(){SoundManager.playOk()},Window_Selectable.prototype.playBuzzerSound=function(){SoundManager.playBuzzer()},Window_Selectable.prototype.callOkHandler=function(){this.callHandler("ok")},Window_Selectable.prototype.processCancel=function(){SoundManager.playCancel(),this.updateInputData(),this.deactivate(),this.callCancelHandler()},Window_Selectable.prototype.callCancelHandler=function(){this.callHandler("cancel")},Window_Selectable.prototype.processPageup=function(){SoundManager.playCursor(),this.updateInputData(),this.deactivate(),this.callHandler("pageup")},Window_Selectable.prototype.processPagedown=function(){SoundManager.playCursor(),this.updateInputData(),this.deactivate(),this.callHandler("pagedown")},Window_Selectable.prototype.updateInputData=function(){Input.update(),TouchInput.update()},Window_Selectable.prototype.updateCursor=function(){if(this._cursorAll){const t=this.maxRows()*this.itemHeight()
this.setCursorRect(0,0,this.contents.width,t),this.setTopRow(0)}else if(this.isCursorVisible()){const t=this.itemRect(this.index())
this.setCursorRect(t.x,t.y,t.width,t.height)}else this.setCursorRect(0,0,0,0)},Window_Selectable.prototype.isCursorVisible=function(){const t=this.row()
return t>=this.topRow()&&t<=this.bottomRow()},Window_Selectable.prototype.ensureCursorVisible=function(){const t=this.row()
t<this.topRow()?this.setTopRow(t):t>this.bottomRow()&&this.setBottomRow(t)},Window_Selectable.prototype.callUpdateHelp=function(){this.active&&this._helpWindow&&this.updateHelp()},Window_Selectable.prototype.updateHelp=function(){this._helpWindow.clear()},Window_Selectable.prototype.setHelpWindowItem=function(t){this._helpWindow&&this._helpWindow.setItem(t)},Window_Selectable.prototype.isCurrentItemEnabled=function(){return!0},Window_Selectable.prototype.drawAllItems=function(){const t=this.topIndex()
for(let e=0;e<this.maxPageItems();e++){const i=t+e
i<this.maxItems()&&this.drawItem(i)}},Window_Selectable.prototype.drawItem=function(t){},Window_Selectable.prototype.clearItem=function(t){const e=this.itemRect(t)
this.contents.clearRect(e.x,e.y,e.width,e.height)},Window_Selectable.prototype.redrawItem=function(t){t>=0&&(this.clearItem(t),this.drawItem(t))},Window_Selectable.prototype.redrawCurrentItem=function(){this.redrawItem(this.index())},Window_Selectable.prototype.refresh=function(){this.contents&&(this.contents.clear(),this.drawAllItems())},Window_Command.prototype=Object.create(Window_Selectable.prototype),Window_Command.prototype.constructor=Window_Command,Window_Command.prototype.initialize=function(t,e){this.clearCommandList(),this.makeCommandList()
const i=this.windowWidth(),o=this.windowHeight()
Window_Selectable.prototype.initialize.call(this,t,e,i,o),this.refresh(),this.select(0),this.activate()},Window_Command.prototype.windowWidth=function(){return 240},Window_Command.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_Command.prototype.numVisibleRows=function(){return Math.ceil(this.maxItems()/this.maxCols())},Window_Command.prototype.maxItems=function(){return this._list.length},Window_Command.prototype.clearCommandList=function(){this._list=[]},Window_Command.prototype.makeCommandList=function(){},Window_Command.prototype.addCommand=function(t,e,i,o){void 0===i&&(i=!0),void 0===o&&(o=null),this._list.push({name:t,symbol:e,enabled:i,ext:o})},Window_Command.prototype.commandName=function(t){return this._list[t].name},Window_Command.prototype.commandSymbol=function(t){return this._list[t].symbol},Window_Command.prototype.isCommandEnabled=function(t){return this._list[t].enabled},Window_Command.prototype.currentData=function(){return this.index()>=0?this._list[this.index()]:null},Window_Command.prototype.isCurrentItemEnabled=function(){return!!this.currentData()&&this.currentData().enabled},Window_Command.prototype.currentSymbol=function(){return this.currentData()?this.currentData().symbol:null},Window_Command.prototype.currentExt=function(){return this.currentData()?this.currentData().ext:null},Window_Command.prototype.findSymbol=function(t){for(let e=0;e<this._list.length;e++)if(this._list[e].symbol===t)return e
return-1},Window_Command.prototype.selectSymbol=function(t){const e=this.findSymbol(t)
e>=0?this.select(e):this.select(0)},Window_Command.prototype.findExt=function(t){for(let e=0;e<this._list.length;e++)if(this._list[e].ext===t)return e
return-1},Window_Command.prototype.selectExt=function(t){const e=this.findExt(t)
e>=0?this.select(e):this.select(0)},Window_Command.prototype.drawItem=function(t){const e=this.itemRectForText(t),i=this.itemTextAlign()
this.resetTextColor(),this.changePaintOpacity(this.isCommandEnabled(t)),this.drawText(this.commandName(t),e.x,e.y,e.width,i)},Window_Command.prototype.itemTextAlign=function(){return"left"},Window_Command.prototype.isOkEnabled=function(){return!0},Window_Command.prototype.callOkHandler=function(){const t=this.currentSymbol()
this.isHandled(t)?this.callHandler(t):this.isHandled("ok")?Window_Selectable.prototype.callOkHandler.call(this):this.activate()},Window_Command.prototype.refresh=function(){this.clearCommandList(),this.makeCommandList(),this.createContents(),Window_Selectable.prototype.refresh.call(this)},Window_HorzCommand.prototype=Object.create(Window_Command.prototype),Window_HorzCommand.prototype.constructor=Window_HorzCommand,Window_HorzCommand.prototype.initialize=function(t,e){Window_Command.prototype.initialize.call(this,t,e)},Window_HorzCommand.prototype.numVisibleRows=function(){return 1},Window_HorzCommand.prototype.maxCols=function(){return 4},Window_HorzCommand.prototype.itemTextAlign=function(){return"center"},Window_Help.prototype=Object.create(Window_Base.prototype),Window_Help.prototype.constructor=Window_Help,Window_Help.prototype.initialize=function(t){const e=Graphics.boxWidth,i=this.fittingHeight(t||2)
Window_Base.prototype.initialize.call(this,0,0,e,i),this._text=""},Window_Help.prototype.setText=function(t){this._text!==t&&(this._text=t,this.refresh())},Window_Help.prototype.clear=function(){this.setText("")},Window_Help.prototype.setItem=function(t){this.setText(t?t.description:"")},Window_Help.prototype.refresh=function(){this.contents.clear(),this.drawTextEx(this._text,this.textPadding(),0)},Window_Gold.prototype=Object.create(Window_Base.prototype),Window_Gold.prototype.constructor=Window_Gold,Window_Gold.prototype.initialize=function(t,e){const i=this.windowWidth(),o=this.windowHeight()
Window_Base.prototype.initialize.call(this,t,e,i,o),this.refresh()},Window_Gold.prototype.windowWidth=function(){return 240},Window_Gold.prototype.windowHeight=function(){return this.fittingHeight(1)},Window_Gold.prototype.refresh=function(){const t=this.textPadding(),e=this.contents.width-2*this.textPadding()
this.contents.clear(),this.drawCurrencyValue(this.value(),this.currencyUnit(),t,0,e)},Window_Gold.prototype.value=function(){return $gameParty.gold()},Window_Gold.prototype.currencyUnit=function(){return TextManager.currencyUnit},Window_Gold.prototype.open=function(){this.refresh(),Window_Base.prototype.open.call(this)},Window_MenuCommand.prototype=Object.create(Window_Command.prototype),Window_MenuCommand.prototype.constructor=Window_MenuCommand,Window_MenuCommand.prototype.initialize=function(t,e){Window_Command.prototype.initialize.call(this,t,e),this.selectLast()},Window_MenuCommand._lastCommandSymbol=null,Window_MenuCommand.initCommandPosition=function(){this._lastCommandSymbol=null},Window_MenuCommand.prototype.windowWidth=function(){return 240},Window_MenuCommand.prototype.numVisibleRows=function(){return this.maxItems()},Window_MenuCommand.prototype.makeCommandList=function(){this.addMainCommands(),this.addFormationCommand(),this.addOriginalCommands(),this.addOptionsCommand(),this.addSaveCommand(),this.addGameEndCommand()},Window_MenuCommand.prototype.addMainCommands=function(){const t=this.areMainCommandsEnabled()
this.needsCommand("item")&&this.addCommand(TextManager.item,"item",t),this.needsCommand("skill")&&this.addCommand(TextManager.skill,"skill",t),this.needsCommand("equip")&&this.addCommand(TextManager.equip,"equip",t),this.needsCommand("status")&&this.addCommand(TextManager.status,"status",t)},Window_MenuCommand.prototype.addFormationCommand=function(){if(this.needsCommand("formation")){const t=this.isFormationEnabled()
this.addCommand(TextManager.formation,"formation",t)}},Window_MenuCommand.prototype.addOriginalCommands=function(){},Window_MenuCommand.prototype.addOptionsCommand=function(){if(this.needsCommand("options")){const t=this.isOptionsEnabled()
this.addCommand(TextManager.options,"options",t)}},Window_MenuCommand.prototype.addSaveCommand=function(){if(this.needsCommand("save")){const t=this.isSaveEnabled()
this.addCommand(TextManager.save,"save",t)}},Window_MenuCommand.prototype.addGameEndCommand=function(){const t=this.isGameEndEnabled()
this.addCommand(TextManager.gameEnd,"gameEnd",t)},Window_MenuCommand.prototype.needsCommand=function(t){const e=$dataSystem.menuCommands
if(e)switch(t){case"item":return e[0]
case"skill":return e[1]
case"equip":return e[2]
case"status":return e[3]
case"formation":return e[4]
case"save":return e[5]}return!0},Window_MenuCommand.prototype.areMainCommandsEnabled=function(){return $gameParty.exists()},Window_MenuCommand.prototype.isFormationEnabled=function(){return $gameParty.size()>=2&&$gameSystem.isFormationEnabled()},Window_MenuCommand.prototype.isOptionsEnabled=function(){return!0},Window_MenuCommand.prototype.isSaveEnabled=function(){return!DataManager.isEventTest()&&$gameSystem.isSaveEnabled()},Window_MenuCommand.prototype.isGameEndEnabled=function(){return!0},Window_MenuCommand.prototype.processOk=function(){Window_MenuCommand._lastCommandSymbol=this.currentSymbol(),Window_Command.prototype.processOk.call(this)},Window_MenuCommand.prototype.selectLast=function(){this.selectSymbol(Window_MenuCommand._lastCommandSymbol)},Window_MenuStatus.prototype=Object.create(Window_Selectable.prototype),Window_MenuStatus.prototype.constructor=Window_MenuStatus,Window_MenuStatus.prototype.initialize=function(t,e){const i=this.windowWidth(),o=this.windowHeight()
Window_Selectable.prototype.initialize.call(this,t,e,i,o),this._formationMode=!1,this._pendingIndex=-1,this.refresh()},Window_MenuStatus.prototype.windowWidth=function(){return Graphics.boxWidth-240},Window_MenuStatus.prototype.windowHeight=function(){return Graphics.boxHeight},Window_MenuStatus.prototype.maxItems=function(){return $gameParty.size()},Window_MenuStatus.prototype.itemHeight=function(){const t=this.height-2*this.padding
return Math.floor(t/this.numVisibleRows())},Window_MenuStatus.prototype.numVisibleRows=function(){return 4},Window_MenuStatus.prototype.loadImages=function(){$gameParty.members().forEach((function(t){ImageManager.reserveFace(t.faceName())}),this)},Window_MenuStatus.prototype.drawItem=function(t){this.drawItemBackground(t),this.drawItemImage(t),this.drawItemStatus(t)},Window_MenuStatus.prototype.drawItemBackground=function(t){if(t===this._pendingIndex){const e=this.itemRect(t),i=this.pendingColor()
this.changePaintOpacity(!1),this.contents.fillRect(e.x,e.y,e.width,e.height,i),this.changePaintOpacity(!0)}},Window_MenuStatus.prototype.drawItemImage=function(t){const e=$gameParty.members()[t],i=this.itemRect(t)
this.changePaintOpacity(e.isBattleMember()),this.drawActorFace(e,i.x+1,i.y+1,Window_Base._faceWidth,Window_Base._faceHeight),this.changePaintOpacity(!0)},Window_MenuStatus.prototype.drawItemStatus=function(t){const e=$gameParty.members()[t],i=this.itemRect(t),o=i.x+162,n=i.y+i.height/2-1.5*this.lineHeight(),s=i.width-o-this.textPadding()
this.drawActorSimpleStatus(e,o,n,s)},Window_MenuStatus.prototype.processOk=function(){Window_Selectable.prototype.processOk.call(this),$gameParty.setMenuActor($gameParty.members()[this.index()])},Window_MenuStatus.prototype.isCurrentItemEnabled=function(){if(this._formationMode){const t=$gameParty.members()[this.index()]
return t&&t.isFormationChangeOk()}return!0},Window_MenuStatus.prototype.selectLast=function(){this.select($gameParty.menuActor().index()||0)},Window_MenuStatus.prototype.formationMode=function(){return this._formationMode},Window_MenuStatus.prototype.setFormationMode=function(t){this._formationMode=t},Window_MenuStatus.prototype.pendingIndex=function(){return this._pendingIndex},Window_MenuStatus.prototype.setPendingIndex=function(t){const e=this._pendingIndex
this._pendingIndex=t,this.redrawItem(this._pendingIndex),this.redrawItem(e)},Window_MenuActor.prototype=Object.create(Window_MenuStatus.prototype),Window_MenuActor.prototype.constructor=Window_MenuActor,Window_MenuActor.prototype.initialize=function(){Window_MenuStatus.prototype.initialize.call(this,0,0),this.hide()},Window_MenuActor.prototype.processOk=function(){this.cursorAll()||$gameParty.setTargetActor($gameParty.members()[this.index()]),this.callOkHandler()},Window_MenuActor.prototype.selectLast=function(){this.select($gameParty.targetActor().index()||0)},Window_MenuActor.prototype.selectForItem=function(t){const e=$gameParty.menuActor(),i=new Game_Action(e)
i.setItemObject(t),this.setCursorFixed(!1),this.setCursorAll(!1),i.isForUser()?DataManager.isSkill(t)?(this.setCursorFixed(!0),this.select(e.index())):this.selectLast():i.isForAll()?(this.setCursorAll(!0),this.select(0)):this.selectLast()},Window_ItemCategory.prototype=Object.create(Window_HorzCommand.prototype),Window_ItemCategory.prototype.constructor=Window_ItemCategory,Window_ItemCategory.prototype.initialize=function(){Window_HorzCommand.prototype.initialize.call(this,0,0)},Window_ItemCategory.prototype.windowWidth=function(){return Graphics.boxWidth},Window_ItemCategory.prototype.maxCols=function(){return 4},Window_ItemCategory.prototype.update=function(){Window_HorzCommand.prototype.update.call(this),this._itemWindow&&this._itemWindow.setCategory(this.currentSymbol())},Window_ItemCategory.prototype.makeCommandList=function(){this.addCommand(TextManager.item,"item"),this.addCommand(TextManager.weapon,"weapon"),this.addCommand(TextManager.armor,"armor"),this.addCommand(TextManager.keyItem,"keyItem")},Window_ItemCategory.prototype.setItemWindow=function(t){this._itemWindow=t},Window_ItemList.prototype=Object.create(Window_Selectable.prototype),Window_ItemList.prototype.constructor=Window_ItemList,Window_ItemList.prototype.initialize=function(t,e,i,o){Window_Selectable.prototype.initialize.call(this,t,e,i,o),this._category="none",this._data=[]},Window_ItemList.prototype.setCategory=function(t){this._category!==t&&(this._category=t,this.refresh(),this.resetScroll())},Window_ItemList.prototype.maxCols=function(){return 2},Window_ItemList.prototype.spacing=function(){return 48},Window_ItemList.prototype.maxItems=function(){return this._data?this._data.length:1},Window_ItemList.prototype.item=function(){const t=this.index()
return this._data&&t>=0?this._data[t]:null},Window_ItemList.prototype.isCurrentItemEnabled=function(){return this.isEnabled(this.item())},Window_ItemList.prototype.includes=function(t){switch(this._category){case"item":return DataManager.isItem(t)&&1===t.itypeId
case"weapon":return DataManager.isWeapon(t)
case"armor":return DataManager.isArmor(t)
case"keyItem":return DataManager.isItem(t)&&2===t.itypeId
default:return!1}},Window_ItemList.prototype.needsNumber=function(){return!0},Window_ItemList.prototype.isEnabled=function(t){return $gameParty.canUse(t)},Window_ItemList.prototype.makeItemList=function(){this._data=$gameParty.allItems().filter((function(t){return this.includes(t)}),this),this.includes(null)&&this._data.push(null)},Window_ItemList.prototype.selectLast=function(){const t=this._data.indexOf($gameParty.lastItem())
this.select(t>=0?t:0)},Window_ItemList.prototype.drawItem=function(t){const e=this._data[t]
if(e){const i=this.numberWidth(),o=this.itemRect(t)
o.width-=this.textPadding(),this.changePaintOpacity(this.isEnabled(e)),this.drawItemName(e,o.x,o.y,o.width-i),this.drawItemNumber(e,o.x,o.y,o.width),this.changePaintOpacity(1)}},Window_ItemList.prototype.numberWidth=function(){return this.textWidth("000")},Window_ItemList.prototype.drawItemNumber=function(t,e,i,o){this.needsNumber()&&(this.drawText(":",e,i,o-this.textWidth("00"),"right"),this.drawText($gameParty.numItems(t),e,i,o,"right"))},Window_ItemList.prototype.updateHelp=function(){this.setHelpWindowItem(this.item())},Window_ItemList.prototype.refresh=function(){this.makeItemList(),this.createContents(),this.drawAllItems()},Window_SkillType.prototype=Object.create(Window_Command.prototype),Window_SkillType.prototype.constructor=Window_SkillType,Window_SkillType.prototype.initialize=function(t,e){Window_Command.prototype.initialize.call(this,t,e),this._actor=null},Window_SkillType.prototype.windowWidth=function(){return 240},Window_SkillType.prototype.setActor=function(t){this._actor!==t&&(this._actor=t,this.refresh(),this.selectLast())},Window_SkillType.prototype.numVisibleRows=function(){return 4},Window_SkillType.prototype.makeCommandList=function(){if(this._actor){const t=this._actor.addedSkillTypes()
t.sort((function(t,e){return t-e})),t.forEach((function(t){const e=$dataSystem.skillTypes[t]
this.addCommand(e,"skill",!0,t)}),this)}},Window_SkillType.prototype.update=function(){Window_Command.prototype.update.call(this),this._skillWindow&&this._skillWindow.setStypeId(this.currentExt())},Window_SkillType.prototype.setSkillWindow=function(t){this._skillWindow=t},Window_SkillType.prototype.selectLast=function(){const t=this._actor.lastMenuSkill()
t?this.selectExt(t.stypeId):this.select(0)},Window_SkillStatus.prototype=Object.create(Window_Base.prototype),Window_SkillStatus.prototype.constructor=Window_SkillStatus,Window_SkillStatus.prototype.initialize=function(t,e,i,o){Window_Base.prototype.initialize.call(this,t,e,i,o),this._actor=null},Window_SkillStatus.prototype.setActor=function(t){this._actor!==t&&(this._actor=t,this.refresh())},Window_SkillStatus.prototype.refresh=function(){if(this.contents.clear(),this._actor){const t=this.width-2*this.padding,e=this.height-2*this.padding,i=e/2-1.5*this.lineHeight(),o=t-162-this.textPadding()
this.drawActorFace(this._actor,0,0,144,e),this.drawActorSimpleStatus(this._actor,162,i,o)}},Window_SkillList.prototype=Object.create(Window_Selectable.prototype),Window_SkillList.prototype.constructor=Window_SkillList,Window_SkillList.prototype.initialize=function(t,e,i,o){Window_Selectable.prototype.initialize.call(this,t,e,i,o),this._actor=null,this._stypeId=0,this._data=[]},Window_SkillList.prototype.setActor=function(t){this._actor!==t&&(this._actor=t,this.refresh(),this.resetScroll())},Window_SkillList.prototype.setStypeId=function(t){this._stypeId!==t&&(this._stypeId=t,this.refresh(),this.resetScroll())},Window_SkillList.prototype.maxCols=function(){return 2},Window_SkillList.prototype.spacing=function(){return 48},Window_SkillList.prototype.maxItems=function(){return this._data?this._data.length:1},Window_SkillList.prototype.item=function(){return this._data&&this.index()>=0?this._data[this.index()]:null},Window_SkillList.prototype.isCurrentItemEnabled=function(){return this.isEnabled(this._data[this.index()])},Window_SkillList.prototype.includes=function(t){return t&&t.stypeId===this._stypeId},Window_SkillList.prototype.isEnabled=function(t){return this._actor&&this._actor.canUse(t)},Window_SkillList.prototype.makeItemList=function(){this._actor?this._data=this._actor.skills().filter((function(t){return this.includes(t)}),this):this._data=[]},Window_SkillList.prototype.selectLast=function(){let t
t=$gameParty.inBattle()?this._actor.lastBattleSkill():this._actor.lastMenuSkill()
const e=this._data.indexOf(t)
this.select(e>=0?e:0)},Window_SkillList.prototype.drawItem=function(t){const e=this._data[t]
if(e){const i=this.costWidth(),o=this.itemRect(t)
o.width-=this.textPadding(),this.changePaintOpacity(this.isEnabled(e)),this.drawItemName(e,o.x,o.y,o.width-i),this.drawSkillCost(e,o.x,o.y,o.width),this.changePaintOpacity(1)}},Window_SkillList.prototype.costWidth=function(){return this.textWidth("000")},Window_SkillList.prototype.drawSkillCost=function(t,e,i,o){this._actor.skillTpCost(t)>0?(this.changeTextColor(this.tpCostColor()),this.drawText(this._actor.skillTpCost(t),e,i,o,"right")):this._actor.skillMpCost(t)>0&&(this.changeTextColor(this.mpCostColor()),this.drawText(this._actor.skillMpCost(t),e,i,o,"right"))},Window_SkillList.prototype.updateHelp=function(){this.setHelpWindowItem(this.item())},Window_SkillList.prototype.refresh=function(){this.makeItemList(),this.createContents(),this.drawAllItems()},Window_EquipStatus.prototype=Object.create(Window_Base.prototype),Window_EquipStatus.prototype.constructor=Window_EquipStatus,Window_EquipStatus.prototype.initialize=function(t,e){const i=this.windowWidth(),o=this.windowHeight()
Window_Base.prototype.initialize.call(this,t,e,i,o),this._actor=null,this._tempActor=null,this.refresh()},Window_EquipStatus.prototype.windowWidth=function(){return 312},Window_EquipStatus.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_EquipStatus.prototype.numVisibleRows=function(){return 7},Window_EquipStatus.prototype.setActor=function(t){this._actor!==t&&(this._actor=t,this.refresh())},Window_EquipStatus.prototype.refresh=function(){if(this.contents.clear(),this._actor){this.drawActorName(this._actor,this.textPadding(),0)
for(let t=0;t<6;t++)this.drawItem(0,this.lineHeight()*(1+t),2+t)}},Window_EquipStatus.prototype.setTempActor=function(t){this._tempActor!==t&&(this._tempActor=t,this.refresh())},Window_EquipStatus.prototype.drawItem=function(t,e,i){this.drawParamName(t+this.textPadding(),e,i),this._actor&&this.drawCurrentParam(t+140,e,i),this.drawRightArrow(t+188,e),this._tempActor&&this.drawNewParam(t+222,e,i)},Window_EquipStatus.prototype.drawParamName=function(t,e,i){this.changeTextColor(this.systemColor()),this.drawText(TextManager.param(i),t,e,120)},Window_EquipStatus.prototype.drawCurrentParam=function(t,e,i){this.resetTextColor(),this.drawText(this._actor.param(i),t,e,48,"right")},Window_EquipStatus.prototype.drawRightArrow=function(t,e){this.changeTextColor(this.systemColor()),this.drawText("→",t,e,32,"center")},Window_EquipStatus.prototype.drawNewParam=function(t,e,i){const o=this._tempActor.param(i),n=o-this._actor.param(i)
this.changeTextColor(this.paramchangeTextColor(n)),this.drawText(o,t,e,48,"right")},Window_EquipCommand.prototype=Object.create(Window_HorzCommand.prototype),Window_EquipCommand.prototype.constructor=Window_EquipCommand,Window_EquipCommand.prototype.initialize=function(t,e,i){this._windowWidth=i,Window_HorzCommand.prototype.initialize.call(this,t,e)},Window_EquipCommand.prototype.windowWidth=function(){return this._windowWidth},Window_EquipCommand.prototype.maxCols=function(){return 3},Window_EquipCommand.prototype.makeCommandList=function(){this.addCommand(TextManager.equip2,"equip"),this.addCommand(TextManager.optimize,"optimize"),this.addCommand(TextManager.clear,"clear")},Window_EquipSlot.prototype=Object.create(Window_Selectable.prototype),Window_EquipSlot.prototype.constructor=Window_EquipSlot,Window_EquipSlot.prototype.initialize=function(t,e,i,o){Window_Selectable.prototype.initialize.call(this,t,e,i,o),this._actor=null,this.refresh()},Window_EquipSlot.prototype.setActor=function(t){this._actor!==t&&(this._actor=t,this.refresh())},Window_EquipSlot.prototype.update=function(){Window_Selectable.prototype.update.call(this),this._itemWindow&&this._itemWindow.setSlotId(this.index())},Window_EquipSlot.prototype.maxItems=function(){return this._actor?this._actor.equipSlots().length:0},Window_EquipSlot.prototype.item=function(){return this._actor?this._actor.equips()[this.index()]:null},Window_EquipSlot.prototype.drawItem=function(t){if(this._actor){const e=this.itemRectForText(t)
this.changeTextColor(this.systemColor()),this.changePaintOpacity(this.isEnabled(t)),this.drawText(this.slotName(t),e.x,e.y,138,this.lineHeight()),this.drawItemName(this._actor.equips()[t],e.x+138,e.y),this.changePaintOpacity(!0)}},Window_EquipSlot.prototype.slotName=function(t){const e=this._actor.equipSlots()
return this._actor?$dataSystem.equipTypes[e[t]]:""},Window_EquipSlot.prototype.isEnabled=function(t){return!!this._actor&&this._actor.isEquipChangeOk(t)},Window_EquipSlot.prototype.isCurrentItemEnabled=function(){return this.isEnabled(this.index())},Window_EquipSlot.prototype.setStatusWindow=function(t){this._statusWindow=t,this.callUpdateHelp()},Window_EquipSlot.prototype.setItemWindow=function(t){this._itemWindow=t},Window_EquipSlot.prototype.updateHelp=function(){Window_Selectable.prototype.updateHelp.call(this),this.setHelpWindowItem(this.item()),this._statusWindow&&this._statusWindow.setTempActor(null)},Window_EquipItem.prototype=Object.create(Window_ItemList.prototype),Window_EquipItem.prototype.constructor=Window_EquipItem,Window_EquipItem.prototype.initialize=function(t,e,i,o){Window_ItemList.prototype.initialize.call(this,t,e,i,o),this._actor=null,this._slotId=0},Window_EquipItem.prototype.setActor=function(t){this._actor!==t&&(this._actor=t,this.refresh(),this.resetScroll())},Window_EquipItem.prototype.setSlotId=function(t){this._slotId!==t&&(this._slotId=t,this.refresh(),this.resetScroll())},Window_EquipItem.prototype.includes=function(t){return null===t||!(this._slotId<0||t.etypeId!==this._actor.equipSlots()[this._slotId])&&this._actor.canEquip(t)},Window_EquipItem.prototype.isEnabled=function(t){return!0},Window_EquipItem.prototype.selectLast=function(){},Window_EquipItem.prototype.setStatusWindow=function(t){this._statusWindow=t,this.callUpdateHelp()},Window_EquipItem.prototype.updateHelp=function(){if(Window_ItemList.prototype.updateHelp.call(this),this._actor&&this._statusWindow){const t=JsonEx.makeDeepCopy(this._actor)
t.forceChangeEquip(this._slotId,this.item()),this._statusWindow.setTempActor(t)}},Window_EquipItem.prototype.playOkSound=function(){},Window_Status.prototype=Object.create(Window_Selectable.prototype),Window_Status.prototype.constructor=Window_Status,Window_Status.prototype.initialize=function(){const t=Graphics.boxWidth,e=Graphics.boxHeight
Window_Selectable.prototype.initialize.call(this,0,0,t,e),this._actor=null,this.refresh(),this.activate()},Window_Status.prototype.setActor=function(t){this._actor!==t&&(this._actor=t,this.refresh())},Window_Status.prototype.refresh=function(){if(this.contents.clear(),this._actor){const t=this.lineHeight()
this.drawBlock1(0*t),this.drawHorzLine(1*t),this.drawBlock2(2*t),this.drawHorzLine(6*t),this.drawBlock3(7*t),this.drawHorzLine(13*t),this.drawBlock4(14*t)}},Window_Status.prototype.drawBlock1=function(t){this.drawActorName(this._actor,6,t),this.drawActorClass(this._actor,192,t),this.drawActorNickname(this._actor,432,t)},Window_Status.prototype.drawBlock2=function(t){this.drawActorFace(this._actor,12,t),this.drawBasicInfo(204,t),this.drawExpInfo(456,t)},Window_Status.prototype.drawBlock3=function(t){this.drawParameters(48,t),this.drawEquipments(432,t)},Window_Status.prototype.drawBlock4=function(t){this.drawProfile(6,t)},Window_Status.prototype.drawHorzLine=function(t){const e=t+this.lineHeight()/2-1
this.contents.paintOpacity=48,this.contents.fillRect(0,e,this.contentsWidth(),2,this.lineColor()),this.contents.paintOpacity=255},Window_Status.prototype.lineColor=function(){return this.normalColor()},Window_Status.prototype.drawBasicInfo=function(t,e){const i=this.lineHeight()
this.drawActorLevel(this._actor,t,e+0*i),this.drawActorIcons(this._actor,t,e+1*i),this.drawActorHp(this._actor,t,e+2*i),this.drawActorMp(this._actor,t,e+3*i)},Window_Status.prototype.drawParameters=function(t,e){const i=this.lineHeight()
for(let o=0;o<6;o++){const n=o+2,s=e+i*o
this.changeTextColor(this.systemColor()),this.drawText(TextManager.param(n),t,s,160),this.resetTextColor(),this.drawText(this._actor.param(n),t+160,s,60,"right")}},Window_Status.prototype.drawExpInfo=function(t,e){const i=this.lineHeight(),o=TextManager.expTotal.format(TextManager.exp),n=TextManager.expNext.format(TextManager.level)
let s=this._actor.currentExp(),a=this._actor.nextRequiredExp()
this._actor.isMaxLevel()&&(s="-------",a="-------"),this.changeTextColor(this.systemColor()),this.drawText(o,t,e+0*i,270),this.drawText(n,t,e+2*i,270),this.resetTextColor(),this.drawText(s,t,e+1*i,270,"right"),this.drawText(a,t,e+3*i,270,"right")},Window_Status.prototype.drawEquipments=function(t,e){const i=this._actor.equips(),o=Math.min(i.length,this.maxEquipmentLines())
for(let n=0;n<o;n++)this.drawItemName(i[n],t,e+this.lineHeight()*n)},Window_Status.prototype.drawProfile=function(t,e){this.drawTextEx(this._actor.profile(),t,e)},Window_Status.prototype.maxEquipmentLines=function(){return 6},Window_Options.prototype=Object.create(Window_Command.prototype),Window_Options.prototype.constructor=Window_Options,Window_Options.prototype.initialize=function(){Window_Command.prototype.initialize.call(this,0,0),this.updatePlacement()},Window_Options.prototype.windowWidth=function(){return 400},Window_Options.prototype.windowHeight=function(){return this.fittingHeight(Math.min(this.numVisibleRows(),12))},Window_Options.prototype.updatePlacement=function(){this.x=(Graphics.boxWidth-this.width)/2,this.y=(Graphics.boxHeight-this.height)/2},Window_Options.prototype.makeCommandList=function(){this.addGeneralOptions(),this.addVolumeOptions()},Window_Options.prototype.addGeneralOptions=function(){this.addCommand(TextManager.alwaysDash,"alwaysDash"),this.addCommand(TextManager.commandRemember,"commandRemember")},Window_Options.prototype.addVolumeOptions=function(){this.addCommand(TextManager.bgmVolume,"bgmVolume"),this.addCommand(TextManager.bgsVolume,"bgsVolume"),this.addCommand(TextManager.meVolume,"meVolume"),this.addCommand(TextManager.seVolume,"seVolume")},Window_Options.prototype.drawItem=function(t){const e=this.itemRectForText(t),i=this.statusWidth(),o=e.width-i
this.resetTextColor(),this.changePaintOpacity(this.isCommandEnabled(t)),this.drawText(this.commandName(t),e.x,e.y,o,"left"),this.drawText(this.statusText(t),e.x+o,e.y,i,"right")},Window_Options.prototype.statusWidth=function(){return 120},Window_Options.prototype.statusText=function(t){const e=this.commandSymbol(t),i=this.getConfigValue(e)
return this.isVolumeSymbol(e)?this.volumeStatusText(i):this.booleanStatusText(i)},Window_Options.prototype.isVolumeSymbol=function(t){return t.contains("Volume")},Window_Options.prototype.booleanStatusText=function(t){return t?"ON":"OFF"},Window_Options.prototype.volumeStatusText=function(t){return t+"%"},Window_Options.prototype.processOk=function(){const t=this.index(),e=this.commandSymbol(t)
let i=this.getConfigValue(e)
this.isVolumeSymbol(e)?(i+=this.volumeOffset(),i>100&&(i=0),i=i.clamp(0,100),this.changeValue(e,i)):this.changeValue(e,!i)},Window_Options.prototype.cursorRight=function(t){const e=this.index(),i=this.commandSymbol(e)
let o=this.getConfigValue(i)
this.isVolumeSymbol(i)?(o+=this.volumeOffset(),o=o.clamp(0,100),this.changeValue(i,o)):this.changeValue(i,!0)},Window_Options.prototype.cursorLeft=function(t){const e=this.index(),i=this.commandSymbol(e)
let o=this.getConfigValue(i)
this.isVolumeSymbol(i)?(o-=this.volumeOffset(),o=o.clamp(0,100),this.changeValue(i,o)):this.changeValue(i,!1)},Window_Options.prototype.volumeOffset=function(){return 20},Window_Options.prototype.changeValue=function(t,e){const i=void 0
this.getConfigValue(t)!==e&&(this.setConfigValue(t,e),this.redrawItem(this.findSymbol(t)),SoundManager.playCursor())},Window_Options.prototype.getConfigValue=function(t){return ConfigManager[t]},Window_Options.prototype.setConfigValue=function(t,e){ConfigManager[t]=e},Window_SavefileList.prototype=Object.create(Window_Selectable.prototype),Window_SavefileList.prototype.constructor=Window_SavefileList,Window_SavefileList.prototype.initialize=function(t,e,i,o){Window_Selectable.prototype.initialize.call(this,t,e,i,o),this.activate(),this._mode=null},Window_SavefileList.prototype.setMode=function(t){this._mode=t},Window_SavefileList.prototype.maxItems=function(){return DataManager.maxSavefiles()},Window_SavefileList.prototype.maxVisibleItems=function(){return 5},Window_SavefileList.prototype.itemHeight=function(){const t=this.height-2*this.padding
return Math.floor(t/this.maxVisibleItems())},Window_SavefileList.prototype.drawItem=function(t){const e=t+1,i=DataManager.isThisGameFile(e),o=DataManager.loadSavefileInfo(e),n=this.itemRectForText(t)
this.resetTextColor(),"load"===this._mode&&this.changePaintOpacity(i),this.drawFileId(e,n.x,n.y),o&&(this.changePaintOpacity(i),this.drawContents(o,n,i),this.changePaintOpacity(!0))},Window_SavefileList.prototype.drawFileId=function(t,e,i){DataManager.isAutoSaveFileId(t)?("save"===this._mode&&this.changePaintOpacity(!1),this.drawText(TextManager.file+" "+t+"(Auto)",e,i,180)):this.drawText(TextManager.file+" "+t,e,i,180)},Window_SavefileList.prototype.drawContents=function(t,e,i){const o=e.y+e.height
e.width>=420&&(this.drawGameTitle(t,e.x+192,e.y,e.width-192),i&&this.drawPartyCharacters(t,e.x+220,o-4))
const n=this.lineHeight(),s=o-n
s>=n&&this.drawPlaytime(t,e.x,s,e.width)},Window_SavefileList.prototype.drawGameTitle=function(t,e,i,o){t.title&&this.drawText(t.title,e,i,o)},Window_SavefileList.prototype.drawPartyCharacters=function(t,e,i){if(t.characters)for(let o=0;o<t.characters.length;o++){const n=t.characters[o]
this.drawCharacter(n[0],n[1],e+48*o,i)}},Window_SavefileList.prototype.drawPlaytime=function(t,e,i,o){t.playtime&&this.drawText(t.playtime,e,i,o,"right")},Window_SavefileList.prototype.playOkSound=function(){},Window_ShopCommand.prototype=Object.create(Window_HorzCommand.prototype),Window_ShopCommand.prototype.constructor=Window_ShopCommand,Window_ShopCommand.prototype.initialize=function(t,e){this._windowWidth=t,this._purchaseOnly=e,Window_HorzCommand.prototype.initialize.call(this,0,0)},Window_ShopCommand.prototype.windowWidth=function(){return this._windowWidth},Window_ShopCommand.prototype.maxCols=function(){return 3},Window_ShopCommand.prototype.makeCommandList=function(){this.addCommand(TextManager.buy,"buy"),this.addCommand(TextManager.sell,"sell",!this._purchaseOnly),this.addCommand(TextManager.cancel,"cancel")},Window_ShopBuy.prototype=Object.create(Window_Selectable.prototype),Window_ShopBuy.prototype.constructor=Window_ShopBuy,Window_ShopBuy.prototype.initialize=function(t,e,i,o){const n=this.windowWidth()
Window_Selectable.prototype.initialize.call(this,t,e,n,i),this._shopGoods=o,this._money=0,this.refresh(),this.select(0)},Window_ShopBuy.prototype.windowWidth=function(){return 456},Window_ShopBuy.prototype.maxItems=function(){return this._data?this._data.length:1},Window_ShopBuy.prototype.item=function(){return this._data[this.index()]},Window_ShopBuy.prototype.setMoney=function(t){this._money=t,this.refresh()},Window_ShopBuy.prototype.isCurrentItemEnabled=function(){return this.isEnabled(this._data[this.index()])},Window_ShopBuy.prototype.price=function(t){return this._price[this._data.indexOf(t)]||0},Window_ShopBuy.prototype.isEnabled=function(t){return t&&this.price(t)<=this._money&&!$gameParty.hasMaxItems(t)},Window_ShopBuy.prototype.refresh=function(){this.makeItemList(),this.createContents(),this.drawAllItems()},Window_ShopBuy.prototype.makeItemList=function(){this._data=[],this._price=[],this._shopGoods.forEach((function(t){let e=null
switch(t[0]){case 0:e=$dataItems[t[1]]
break
case 1:e=$dataWeapons[t[1]]
break
case 2:e=$dataArmors[t[1]]}e&&(this._data.push(e),this._price.push(0===t[2]?e.price:t[3]))}),this)},Window_ShopBuy.prototype.drawItem=function(t){const e=this._data[t],i=this.itemRect(t),o=96
i.width-=this.textPadding(),this.changePaintOpacity(this.isEnabled(e)),this.drawItemName(e,i.x,i.y,i.width-o),this.drawText(this.price(e),i.x+i.width-o,i.y,o,"right"),this.changePaintOpacity(!0)},Window_ShopBuy.prototype.setStatusWindow=function(t){this._statusWindow=t,this.callUpdateHelp()},Window_ShopBuy.prototype.updateHelp=function(){this.setHelpWindowItem(this.item()),this._statusWindow&&this._statusWindow.setItem(this.item())},Window_ShopSell.prototype=Object.create(Window_ItemList.prototype),Window_ShopSell.prototype.constructor=Window_ShopSell,Window_ShopSell.prototype.initialize=function(t,e,i,o){Window_ItemList.prototype.initialize.call(this,t,e,i,o)},Window_ShopSell.prototype.isEnabled=function(t){return t&&t.price>0},Window_ShopNumber.prototype=Object.create(Window_Selectable.prototype),Window_ShopNumber.prototype.constructor=Window_ShopNumber,Window_ShopNumber.prototype.initialize=function(t,e,i){const o=this.windowWidth()
Window_Selectable.prototype.initialize.call(this,t,e,o,i),this._item=null,this._max=1,this._price=0,this._number=1,this._currencyUnit=TextManager.currencyUnit,this.createButtons()},Window_ShopNumber.prototype.windowWidth=function(){return 456},Window_ShopNumber.prototype.number=function(){return this._number},Window_ShopNumber.prototype.setup=function(t,e,i){this._item=t,this._max=Math.floor(e),this._price=i,this._number=1,this.placeButtons(),this.updateButtonsVisiblity(),this.refresh()},Window_ShopNumber.prototype.setCurrencyUnit=function(t){this._currencyUnit=t,this.refresh()},Window_ShopNumber.prototype.createButtons=function(){const t=ImageManager.loadSystem("ButtonSet"),e=48,i=48
this._buttons=[]
for(let o=0;o<5;o++){const n=new Sprite_Button,s=e*o,a=e*(4===o?2:1)
n.bitmap=t,n.setColdFrame(s,0,a,i),n.setHotFrame(s,i,a,i),n.visible=!1,this._buttons.push(n),this.addChild(n)}this._buttons[0].setClickHandler(this.onButtonDown2.bind(this)),this._buttons[1].setClickHandler(this.onButtonDown.bind(this)),this._buttons[2].setClickHandler(this.onButtonUp.bind(this)),this._buttons[3].setClickHandler(this.onButtonUp2.bind(this)),this._buttons[4].setClickHandler(this.onButtonOk.bind(this))},Window_ShopNumber.prototype.placeButtons=function(){const t=this._buttons.length,e=16
let i=-16
for(let o=0;o<t;o++)i+=this._buttons[o].width+e
let o=(this.width-i)/2
for(let i=0;i<t;i++){const t=this._buttons[i]
t.x=o,t.y=this.buttonY(),o+=t.width+e}},Window_ShopNumber.prototype.updateButtonsVisiblity=function(){TouchInput.date>Input.date?this.showButtons():this.hideButtons()},Window_ShopNumber.prototype.showButtons=function(){for(let t=0;t<this._buttons.length;t++)this._buttons[t].visible=!0},Window_ShopNumber.prototype.hideButtons=function(){for(let t=0;t<this._buttons.length;t++)this._buttons[t].visible=!1},Window_ShopNumber.prototype.refresh=function(){this.contents.clear(),this.drawItemName(this._item,0,this.itemY()),this.drawMultiplicationSign(),this.drawNumber(),this.drawTotalPrice()},Window_ShopNumber.prototype.drawMultiplicationSign=function(){const t="×",e=this.textWidth(t),i=this.cursorX()-2*e,o=this.itemY()
this.resetTextColor(),this.drawText(t,i,o,e)},Window_ShopNumber.prototype.drawNumber=function(){const t=this.cursorX(),e=this.itemY(),i=this.cursorWidth()-this.textPadding()
this.resetTextColor(),this.drawText(this._number,t,e,i,"right")},Window_ShopNumber.prototype.drawTotalPrice=function(){const t=this._price*this._number,e=this.contentsWidth()-this.textPadding()
this.drawCurrencyValue(t,this._currencyUnit,0,this.priceY(),e)},Window_ShopNumber.prototype.itemY=function(){return Math.round(this.contentsHeight()/2-1.5*this.lineHeight())},Window_ShopNumber.prototype.priceY=function(){return Math.round(this.contentsHeight()/2+this.lineHeight()/2)},Window_ShopNumber.prototype.buttonY=function(){return Math.round(this.priceY()+2.5*this.lineHeight())},Window_ShopNumber.prototype.cursorWidth=function(){const t=this.textWidth("0")
return this.maxDigits()*t+2*this.textPadding()},Window_ShopNumber.prototype.cursorX=function(){return this.contentsWidth()-this.cursorWidth()-this.textPadding()},Window_ShopNumber.prototype.maxDigits=function(){return 2},Window_ShopNumber.prototype.update=function(){Window_Selectable.prototype.update.call(this),this.processNumberChange()},Window_ShopNumber.prototype.isOkTriggered=function(){return Input.isTriggered("ok")},Window_ShopNumber.prototype.playOkSound=function(){},Window_ShopNumber.prototype.processNumberChange=function(){this.isOpenAndActive()&&(Input.isRepeated("right")&&this.changeNumber(1),Input.isRepeated("left")&&this.changeNumber(-1),Input.isRepeated("up")&&this.changeNumber(10),Input.isRepeated("down")&&this.changeNumber(-10))},Window_ShopNumber.prototype.changeNumber=function(t){const e=this._number
this._number=(this._number+t).clamp(1,this._max),this._number!==e&&(SoundManager.playCursor(),this.refresh())},Window_ShopNumber.prototype.updateCursor=function(){this.setCursorRect(this.cursorX(),this.itemY(),this.cursorWidth(),this.lineHeight())},Window_ShopNumber.prototype.onButtonUp=function(){this.changeNumber(1)},Window_ShopNumber.prototype.onButtonUp2=function(){this.changeNumber(10)},Window_ShopNumber.prototype.onButtonDown=function(){this.changeNumber(-1)},Window_ShopNumber.prototype.onButtonDown2=function(){this.changeNumber(-10)},Window_ShopNumber.prototype.onButtonOk=function(){this.processOk()},Window_ShopStatus.prototype=Object.create(Window_Base.prototype),Window_ShopStatus.prototype.constructor=Window_ShopStatus,Window_ShopStatus.prototype.initialize=function(t,e,i,o){Window_Base.prototype.initialize.call(this,t,e,i,o),this._item=null,this._pageIndex=0,this.refresh()},Window_ShopStatus.prototype.refresh=function(){if(this.contents.clear(),this._item){const t=this.textPadding()
this.drawPossession(t,0),this.isEquipItem()&&this.drawEquipInfo(t,2*this.lineHeight())}},Window_ShopStatus.prototype.setItem=function(t){this._item=t,this.refresh()},Window_ShopStatus.prototype.isEquipItem=function(){return DataManager.isWeapon(this._item)||DataManager.isArmor(this._item)},Window_ShopStatus.prototype.drawPossession=function(t,e){const i=this.contents.width-this.textPadding()-t,o=this.textWidth("0000")
this.changeTextColor(this.systemColor()),this.drawText(TextManager.possession,t,e,i-o),this.resetTextColor(),this.drawText($gameParty.numItems(this._item),t,e,i,"right")},Window_ShopStatus.prototype.drawEquipInfo=function(t,e){const i=this.statusMembers()
for(let o=0;o<i.length;o++)this.drawActorEquipInfo(t,e+2.4*this.lineHeight()*o,i[o])},Window_ShopStatus.prototype.statusMembers=function(){const t=this._pageIndex*this.pageSize(),e=t+this.pageSize()
return $gameParty.members().slice(t,e)},Window_ShopStatus.prototype.pageSize=function(){return 4},Window_ShopStatus.prototype.maxPages=function(){return Math.floor(($gameParty.size()+this.pageSize()-1)/this.pageSize())},Window_ShopStatus.prototype.drawActorEquipInfo=function(t,e,i){const o=i.canEquip(this._item)
this.changePaintOpacity(o),this.resetTextColor(),this.drawText(i.name(),t,e,168)
const n=this.currentEquippedItem(i,this._item.etypeId)
o&&this.drawActorParamChange(t,e,i,n),this.drawItemName(n,t,e+this.lineHeight()),this.changePaintOpacity(!0)},Window_ShopStatus.prototype.drawActorParamChange=function(t,e,i,o){const n=this.contents.width-this.textPadding()-t,s=this.paramId(),a=this._item.params[s]-(o?o.params[s]:0)
this.changeTextColor(this.paramchangeTextColor(a)),this.drawText((a>0?"+":"")+a,t,e,n,"right")},Window_ShopStatus.prototype.paramId=function(){return DataManager.isWeapon(this._item)?2:3},Window_ShopStatus.prototype.currentEquippedItem=function(t,e){const i=[],o=t.equips(),n=t.equipSlots()
for(let t=0;t<n.length;t++)n[t]===e&&i.push(o[t])
const s=this.paramId()
let a=Number.MAX_VALUE,r=null
for(let t=0;t<i.length;t++)i[t]&&i[t].params[s]<a&&(a=i[t].params[s],r=i[t])
return r},Window_ShopStatus.prototype.update=function(){Window_Base.prototype.update.call(this),this.updatePage()},Window_ShopStatus.prototype.updatePage=function(){this.isPageChangeEnabled()&&this.isPageChangeRequested()&&this.changePage()},Window_ShopStatus.prototype.isPageChangeEnabled=function(){return this.visible&&this.maxPages()>=2},Window_ShopStatus.prototype.isPageChangeRequested=function(){return!!Input.isTriggered("shift")||!(!TouchInput.isTriggered()||!this.isTouchedInsideFrame())},Window_ShopStatus.prototype.isTouchedInsideFrame=function(){const t=this.canvasToLocalX(TouchInput.x),e=this.canvasToLocalY(TouchInput.y)
return t>=0&&e>=0&&t<this.width&&e<this.height},Window_ShopStatus.prototype.changePage=function(){this._pageIndex=(this._pageIndex+1)%this.maxPages(),this.refresh(),SoundManager.playCursor()},Window_NameEdit.prototype=Object.create(Window_Base.prototype),Window_NameEdit.prototype.constructor=Window_NameEdit,Window_NameEdit.prototype.initialize=function(t,e){const i=this.windowWidth(),o=this.windowHeight(),n=(Graphics.boxWidth-i)/2,s=(Graphics.boxHeight-(o+this.fittingHeight(9)+8))/2
Window_Base.prototype.initialize.call(this,n,s,i,o),this._actor=t,this._name=t.name().slice(0,this._maxLength),this._index=this._name.length,this._maxLength=e,this._defaultName=this._name,this.deactivate(),this.refresh(),ImageManager.reserveFace(t.faceName())},Window_NameEdit.prototype.windowWidth=function(){return 480},Window_NameEdit.prototype.windowHeight=function(){return this.fittingHeight(4)},Window_NameEdit.prototype.name=function(){return this._name},Window_NameEdit.prototype.restoreDefault=function(){return this._name=this._defaultName,this._index=this._name.length,this.refresh(),this._name.length>0},Window_NameEdit.prototype.add=function(t){return this._index<this._maxLength&&(this._name+=t,this._index++,this.refresh(),!0)},Window_NameEdit.prototype.back=function(){return this._index>0&&(this._index--,this._name=this._name.slice(0,this._index),this.refresh(),!0)},Window_NameEdit.prototype.faceWidth=function(){return 144},Window_NameEdit.prototype.charWidth=function(){const t=$gameSystem.isJapanese()?"Ａ":"A"
return this.textWidth(t)},Window_NameEdit.prototype.left=function(){const t=(this.contentsWidth()+this.faceWidth())/2,e=(this._maxLength+1)*this.charWidth()
return Math.min(t-e/2,this.contentsWidth()-e)},Window_NameEdit.prototype.itemRect=function(t){return{x:this.left()+t*this.charWidth(),y:54,width:this.charWidth(),height:this.lineHeight()}},Window_NameEdit.prototype.underlineRect=function(t){const e=this.itemRect(t)
return e.x++,e.y+=e.height-4,e.width-=2,e.height=2,e},Window_NameEdit.prototype.underlineColor=function(){return this.normalColor()},Window_NameEdit.prototype.drawUnderline=function(t){const e=this.underlineRect(t),i=this.underlineColor()
this.contents.paintOpacity=48,this.contents.fillRect(e.x,e.y,e.width,e.height,i),this.contents.paintOpacity=255},Window_NameEdit.prototype.drawChar=function(t){const e=this.itemRect(t)
this.resetTextColor(),this.drawText(this._name[t]||"",e.x,e.y)},Window_NameEdit.prototype.refresh=function(){this.contents.clear(),this.drawActorFace(this._actor,0,0)
for(let t=0;t<this._maxLength;t++)this.drawUnderline(t)
for(let t=0;t<this._name.length;t++)this.drawChar(t)
const t=this.itemRect(this._index)
this.setCursorRect(t.x,t.y,t.width,t.height)},Window_NameInput.prototype=Object.create(Window_Selectable.prototype),Window_NameInput.prototype.constructor=Window_NameInput,Window_NameInput.LATIN1=["A","B","C","D","E","a","b","c","d","e","F","G","H","I","J","f","g","h","i","j","K","L","M","N","O","k","l","m","n","o","P","Q","R","S","T","p","q","r","s","t","U","V","W","X","Y","u","v","w","x","y","Z","[","]","^","_","z","{","}","|","~","0","1","2","3","4","!","#","$","%","&","5","6","7","8","9","(",")","*","+","-","/","=","@","<",">",":",";"," ","Page","OK"],Window_NameInput.LATIN2=["Á","É","Í","Ó","Ú","á","é","í","ó","ú","À","È","Ì","Ò","Ù","à","è","ì","ò","ù","Â","Ê","Î","Ô","Û","â","ê","î","ô","û","Ä","Ë","Ï","Ö","Ü","ä","ë","ï","ö","ü","Ā","Ē","Ī","Ō","Ū","ā","ē","ī","ō","ū","Ã","Å","Æ","Ç","Ð","ã","å","æ","ç","ð","Ñ","Õ","Ø","Š","Ŵ","ñ","õ","ø","š","ŵ","Ý","Ŷ","Ÿ","Ž","Þ","ý","ÿ","ŷ","ž","þ","Ĳ","Œ","ĳ","œ","ß","«","»"," ","Page","OK"],Window_NameInput.RUSSIA=["А","Б","В","Г","Д","а","б","в","г","д","Е","Ё","Ж","З","И","е","ё","ж","з","и","Й","К","Л","М","Н","й","к","л","м","н","О","П","Р","С","Т","о","п","р","с","т","У","Ф","Х","Ц","Ч","у","ф","х","ц","ч","Ш","Щ","Ъ","Ы","Ь","ш","щ","ъ","ы","ь","Э","Ю","Я","^","_","э","ю","я","%","&","0","1","2","3","4","(",")","*","+","-","5","6","7","8","9",":",";"," ","","OK"],Window_NameInput.JAPAN1=["あ","い","う","え","お","が","ぎ","ぐ","げ","ご","か","き","く","け","こ","ざ","じ","ず","ぜ","ぞ","さ","し","す","せ","そ","だ","ぢ","づ","で","ど","た","ち","つ","て","と","ば","び","ぶ","べ","ぼ","な","に","ぬ","ね","の","ぱ","ぴ","ぷ","ぺ","ぽ","は","ひ","ふ","へ","ほ","ぁ","ぃ","ぅ","ぇ","ぉ","ま","み","む","め","も","っ","ゃ","ゅ","ょ","ゎ","や","ゆ","よ","わ","ん","ー","～","・","＝","☆","ら","り","る","れ","ろ","ゔ","を","　","カナ","決定"],Window_NameInput.JAPAN2=["ア","イ","ウ","エ","オ","ガ","ギ","グ","ゲ","ゴ","カ","キ","ク","ケ","コ","ザ","ジ","ズ","ゼ","ゾ","サ","シ","ス","セ","ソ","ダ","ヂ","ヅ","デ","ド","タ","チ","ツ","テ","ト","バ","ビ","ブ","ベ","ボ","ナ","ニ","ヌ","ネ","ノ","パ","ピ","プ","ペ","ポ","ハ","ヒ","フ","ヘ","ホ","ァ","ィ","ゥ","ェ","ォ","マ","ミ","ム","メ","モ","ッ","ャ","ュ","ョ","ヮ","ヤ","ユ","ヨ","ワ","ン","ー","～","・","＝","☆","ラ","リ","ル","レ","ロ","ヴ","ヲ","　","英数","決定"],Window_NameInput.JAPAN3=["Ａ","Ｂ","Ｃ","Ｄ","Ｅ","ａ","ｂ","ｃ","ｄ","ｅ","Ｆ","Ｇ","Ｈ","Ｉ","Ｊ","ｆ","ｇ","ｈ","ｉ","ｊ","Ｋ","Ｌ","Ｍ","Ｎ","Ｏ","ｋ","ｌ","ｍ","ｎ","ｏ","Ｐ","Ｑ","Ｒ","Ｓ","Ｔ","ｐ","ｑ","ｒ","ｓ","ｔ","Ｕ","Ｖ","Ｗ","Ｘ","Ｙ","ｕ","ｖ","ｗ","ｘ","ｙ","Ｚ","［","］","＾","＿","ｚ","｛","｝","｜","～","０","１","２","３","４","！","＃","＄","％","＆","５","６","７","８","９","（","）","＊","＋","－","／","＝","＠","＜","＞","：","；","　","かな","決定"],Window_NameInput.prototype.initialize=function(t){const e=t.x,i=t.y+t.height+8,o=t.width,n=this.windowHeight()
Window_Selectable.prototype.initialize.call(this,e,i,o,n),this._editWindow=t,this._page=0,this._index=0,this.refresh(),this.updateCursor(),this.activate()},Window_NameInput.prototype.windowHeight=function(){return this.fittingHeight(9)},Window_NameInput.prototype.table=function(){return $gameSystem.isJapanese()?[Window_NameInput.JAPAN1,Window_NameInput.JAPAN2,Window_NameInput.JAPAN3]:$gameSystem.isRussian()?[Window_NameInput.RUSSIA]:[Window_NameInput.LATIN1,Window_NameInput.LATIN2]},Window_NameInput.prototype.maxCols=function(){return 10},Window_NameInput.prototype.maxItems=function(){return 90},Window_NameInput.prototype.character=function(){return this._index<88?this.table()[this._page][this._index]:""},Window_NameInput.prototype.isPageChange=function(){return 88===this._index},Window_NameInput.prototype.isOk=function(){return 89===this._index},Window_NameInput.prototype.itemRect=function(t){return{x:t%10*42+24*Math.floor(t%10/5),y:Math.floor(t/10)*this.lineHeight(),width:42,height:this.lineHeight()}},Window_NameInput.prototype.refresh=function(){const t=this.table()
this.contents.clear(),this.resetTextColor()
for(let e=0;e<90;e++){const i=this.itemRect(e)
i.x+=3,i.width-=6,this.drawText(t[this._page][e],i.x,i.y,i.width,"center")}},Window_NameInput.prototype.updateCursor=function(){const t=this.itemRect(this._index)
this.setCursorRect(t.x,t.y,t.width,t.height)},Window_NameInput.prototype.isCursorMovable=function(){return this.active},Window_NameInput.prototype.cursorDown=function(t){(this._index<80||t)&&(this._index=(this._index+10)%90)},Window_NameInput.prototype.cursorUp=function(t){(this._index>=10||t)&&(this._index=(this._index+80)%90)},Window_NameInput.prototype.cursorRight=function(t){this._index%10<9?this._index++:t&&(this._index-=9)},Window_NameInput.prototype.cursorLeft=function(t){this._index%10>0?this._index--:t&&(this._index+=9)},Window_NameInput.prototype.cursorPagedown=function(){this._page=(this._page+1)%this.table().length,this.refresh()},Window_NameInput.prototype.cursorPageup=function(){this._page=(this._page+this.table().length-1)%this.table().length,this.refresh()},Window_NameInput.prototype.processCursorMove=function(){const t=this._page
Window_Selectable.prototype.processCursorMove.call(this),this.updateCursor(),this._page!==t&&SoundManager.playCursor()},Window_NameInput.prototype.processHandling=function(){this.isOpen()&&this.active&&(Input.isTriggered("shift")&&this.processJump(),Input.isRepeated("cancel")&&this.processBack(),Input.isRepeated("ok")&&this.processOk())},Window_NameInput.prototype.isCancelEnabled=function(){return!0},Window_NameInput.prototype.processCancel=function(){this.processBack()},Window_NameInput.prototype.processJump=function(){89!==this._index&&(this._index=89,SoundManager.playCursor())},Window_NameInput.prototype.processBack=function(){this._editWindow.back()&&SoundManager.playCancel()},Window_NameInput.prototype.processOk=function(){this.character()?this.onNameAdd():this.isPageChange()?(SoundManager.playOk(),this.cursorPagedown()):this.isOk()&&this.onNameOk()},Window_NameInput.prototype.onNameAdd=function(){this._editWindow.add(this.character())?SoundManager.playOk():SoundManager.playBuzzer()},Window_NameInput.prototype.onNameOk=function(){""===this._editWindow.name()?this._editWindow.restoreDefault()?SoundManager.playOk():SoundManager.playBuzzer():(SoundManager.playOk(),this.callOkHandler())},Window_ChoiceList.prototype=Object.create(Window_Command.prototype),Window_ChoiceList.prototype.constructor=Window_ChoiceList,Window_ChoiceList.prototype.initialize=function(t){this._messageWindow=t,Window_Command.prototype.initialize.call(this,0,0),this.openness=0,this.deactivate(),this._background=0},Window_ChoiceList.prototype.start=function(){this.updatePlacement(),this.updateBackground(),this.refresh(),this.selectDefault(),this.open(),this.activate()},Window_ChoiceList.prototype.selectDefault=function(){this.select($gameMessage.choiceDefaultType())},Window_ChoiceList.prototype.updatePlacement=function(){const t=$gameMessage.choicePositionType(),e=this._messageWindow.y
switch(this.width=this.windowWidth(),this.height=this.windowHeight(),t){case 0:this.x=0
break
case 1:this.x=(Graphics.boxWidth-this.width)/2
break
case 2:this.x=Graphics.boxWidth-this.width}e>=Graphics.boxHeight/2?this.y=e-this.height:this.y=e+this._messageWindow.height},Window_ChoiceList.prototype.updateBackground=function(){this._background=$gameMessage.choiceBackground(),this.setBackgroundType(this._background)},Window_ChoiceList.prototype.windowWidth=function(){const t=this.maxChoiceWidth()+2*this.padding
return Math.min(t,Graphics.boxWidth)},Window_ChoiceList.prototype.numVisibleRows=function(){const t=this._messageWindow.y,e=this._messageWindow.height,i=Graphics.boxHeight/2,o=void 0
let n=$gameMessage.choices().length,s=8
return t<i&&t+e>i&&(s=4),n>s&&(n=s),n},Window_ChoiceList.prototype.maxChoiceWidth=function(){let t=96
const e=$gameMessage.choices()
for(let i=0;i<e.length;i++){const o=this.textWidthEx(e[i])+2*this.textPadding()
t<o&&(t=o)}return t},Window_ChoiceList.prototype.textWidthEx=function(t){return this.drawTextEx(t,0,this.contents.height)},Window_ChoiceList.prototype.contentsHeight=function(){return this.maxItems()*this.itemHeight()},Window_ChoiceList.prototype.makeCommandList=function(){const t=$gameMessage.choices()
for(let e=0;e<t.length;e++)this.addCommand(t[e],"choice")},Window_ChoiceList.prototype.drawItem=function(t){const e=this.itemRectForText(t)
this.drawTextEx(this.commandName(t),e.x,e.y)},Window_ChoiceList.prototype.isCancelEnabled=function(){return-1!==$gameMessage.choiceCancelType()},Window_ChoiceList.prototype.isOkTriggered=function(){return Input.isTriggered("ok")},Window_ChoiceList.prototype.callOkHandler=function(){$gameMessage.onChoice(this.index()),this._messageWindow.terminateMessage(),this.close()},Window_ChoiceList.prototype.callCancelHandler=function(){$gameMessage.onChoice($gameMessage.choiceCancelType()),this._messageWindow.terminateMessage(),this.close()},Window_NumberInput.prototype=Object.create(Window_Selectable.prototype),Window_NumberInput.prototype.constructor=Window_NumberInput,Window_NumberInput.prototype.initialize=function(t){this._messageWindow=t,Window_Selectable.prototype.initialize.call(this,0,0,0,0),this._number=0,this._maxDigits=1,this.openness=0,this.createButtons(),this.deactivate()},Window_NumberInput.prototype.start=function(){this._maxDigits=$gameMessage.numInputMaxDigits(),this._number=$gameVariables.value($gameMessage.numInputVariableId()),this._number=this._number.clamp(0,Math.pow(10,this._maxDigits)-1),this.updatePlacement(),this.placeButtons(),this.updateButtonsVisiblity(),this.createContents(),this.refresh(),this.open(),this.activate(),this.select(0)},Window_NumberInput.prototype.updatePlacement=function(){const t=this._messageWindow.y,e=8
this.width=this.windowWidth(),this.height=this.windowHeight(),this.x=(Graphics.boxWidth-this.width)/2,t>=Graphics.boxHeight/2?this.y=t-this.height-8:this.y=t+this._messageWindow.height+8},Window_NumberInput.prototype.windowWidth=function(){return this.maxCols()*this.itemWidth()+2*this.padding},Window_NumberInput.prototype.windowHeight=function(){return this.fittingHeight(1)},Window_NumberInput.prototype.maxCols=function(){return this._maxDigits},Window_NumberInput.prototype.maxItems=function(){return this._maxDigits},Window_NumberInput.prototype.spacing=function(){return 0},Window_NumberInput.prototype.itemWidth=function(){return 32},Window_NumberInput.prototype.createButtons=function(){const t=ImageManager.loadSystem("ButtonSet"),e=48,i=48
this._buttons=[]
for(let o=0;o<3;o++){const n=new Sprite_Button,s=e*[1,2,4][o],a=e*(2===o?2:1)
n.bitmap=t,n.setColdFrame(s,0,a,i),n.setHotFrame(s,i,a,i),n.visible=!1,this._buttons.push(n),this.addChild(n)}this._buttons[0].setClickHandler(this.onButtonDown.bind(this)),this._buttons[1].setClickHandler(this.onButtonUp.bind(this)),this._buttons[2].setClickHandler(this.onButtonOk.bind(this))},Window_NumberInput.prototype.placeButtons=function(){const t=this._buttons.length,e=16
let i=-16
for(let o=0;o<t;o++)i+=this._buttons[o].width+e
let o=(this.width-i)/2
for(let i=0;i<t;i++){const t=this._buttons[i]
t.x=o,t.y=this.buttonY(),o+=t.width+e}},Window_NumberInput.prototype.updateButtonsVisiblity=function(){TouchInput.date>Input.date?this.showButtons():this.hideButtons()},Window_NumberInput.prototype.showButtons=function(){for(let t=0;t<this._buttons.length;t++)this._buttons[t].visible=!0},Window_NumberInput.prototype.hideButtons=function(){for(let t=0;t<this._buttons.length;t++)this._buttons[t].visible=!1},Window_NumberInput.prototype.buttonY=function(){const t=8
return this._messageWindow.y>=Graphics.boxHeight/2?0-this._buttons[0].height-8:this.height+8},Window_NumberInput.prototype.update=function(){Window_Selectable.prototype.update.call(this),this.processDigitChange()},Window_NumberInput.prototype.processDigitChange=function(){this.isOpenAndActive()&&(Input.isRepeated("up")?this.changeDigit(!0):Input.isRepeated("down")&&this.changeDigit(!1))},Window_NumberInput.prototype.changeDigit=function(t){const e=this.index(),i=Math.pow(10,this._maxDigits-1-e)
let o=Math.floor(this._number/i)%10
this._number-=o*i,o=t?(o+1)%10:(o+9)%10,this._number+=o*i,this.refresh(),SoundManager.playCursor()},Window_NumberInput.prototype.isTouchOkEnabled=function(){return!1},Window_NumberInput.prototype.isOkEnabled=function(){return!0},Window_NumberInput.prototype.isCancelEnabled=function(){return!1},Window_NumberInput.prototype.isOkTriggered=function(){return Input.isTriggered("ok")},Window_NumberInput.prototype.processOk=function(){SoundManager.playOk(),$gameVariables.setValue($gameMessage.numInputVariableId(),this._number),this._messageWindow.terminateMessage(),this.updateInputData(),this.deactivate(),this.close()},Window_NumberInput.prototype.drawItem=function(t){const e=this.itemRect(t),i="center",o=void 0,n=this._number.padZero(this._maxDigits).slice(t,t+1)
this.resetTextColor(),this.drawText(n,e.x,e.y,e.width,i)},Window_NumberInput.prototype.onButtonUp=function(){this.changeDigit(!0)},Window_NumberInput.prototype.onButtonDown=function(){this.changeDigit(!1)},Window_NumberInput.prototype.onButtonOk=function(){this.processOk(),this.hideButtons()},Window_EventItem.prototype=Object.create(Window_ItemList.prototype),Window_EventItem.prototype.constructor=Window_EventItem,Window_EventItem.prototype.initialize=function(t){this._messageWindow=t
const e=Graphics.boxWidth,i=this.windowHeight()
Window_ItemList.prototype.initialize.call(this,0,0,e,i),this.openness=0,this.deactivate(),this.setHandler("ok",this.onOk.bind(this)),this.setHandler("cancel",this.onCancel.bind(this))},Window_EventItem.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_EventItem.prototype.numVisibleRows=function(){return 4},Window_EventItem.prototype.start=function(){this.refresh(),this.updatePlacement(),this.select(0),this.open(),this.activate()},Window_EventItem.prototype.updatePlacement=function(){this._messageWindow.y>=Graphics.boxHeight/2?this.y=0:this.y=Graphics.boxHeight-this.height},Window_EventItem.prototype.includes=function(t){const e=$gameMessage.itemChoiceItypeId()
return DataManager.isItem(t)&&t.itypeId===e},Window_EventItem.prototype.isEnabled=function(t){return!0},Window_EventItem.prototype.onOk=function(){const t=this.item(),e=t?t.id:0
$gameVariables.setValue($gameMessage.itemChoiceVariableId(),e),this._messageWindow.terminateMessage(),this.close()},Window_EventItem.prototype.onCancel=function(){$gameVariables.setValue($gameMessage.itemChoiceVariableId(),0),this._messageWindow.terminateMessage(),this.close()},Window_Message.prototype=Object.create(Window_Base.prototype),Window_Message.prototype.constructor=Window_Message,Window_Message.prototype.initialize=function(){const t=this.windowWidth(),e=this.windowHeight(),i=(Graphics.boxWidth-t)/2
Window_Base.prototype.initialize.call(this,i,0,t,e),this.openness=0,this.initMembers(),this.createSubWindows(),this.updatePlacement()},Window_Message.prototype.initMembers=function(){this._imageReservationId=Utils.generateRuntimeId(),this._background=0,this._positionType=2,this._waitCount=0,this._faceBitmap=null,this._textState=null,this.clearFlags()},Window_Message.prototype.subWindows=function(){return[this._goldWindow,this._choiceWindow,this._numberWindow,this._itemWindow]},Window_Message.prototype.createSubWindows=function(){this._goldWindow=new Window_Gold(0,0),this._goldWindow.x=Graphics.boxWidth-this._goldWindow.width,this._goldWindow.openness=0,this._choiceWindow=new Window_ChoiceList(this),this._numberWindow=new Window_NumberInput(this),this._itemWindow=new Window_EventItem(this)},Window_Message.prototype.windowWidth=function(){return Graphics.boxWidth},Window_Message.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_Message.prototype.clearFlags=function(){this._showFast=!1,this._lineShowFast=!1,this._pauseSkip=!1,this._textSpeed=0,this._textSpeedCount=0},Window_Message.prototype.numVisibleRows=function(){return 4},Window_Message.prototype.update=function(){for(this.checkToNotClose(),Window_Base.prototype.update.call(this);!this.isOpening()&&!this.isClosing();){if(this.updateWait())return
if(this.updateLoading())return
if(this.updateInput())return
if(this.updateMessage())return
if(!this.canStart())return void this.startInput()
this.startMessage()}},Window_Message.prototype.checkToNotClose=function(){this.isClosing()&&this.isOpen()&&this.doesContinue()&&this.open()},Window_Message.prototype.canStart=function(){return $gameMessage.hasText()&&!$gameMessage.scrollMode()},Window_Message.prototype.startMessage=function(){this._textState={},this._textState.index=0,this._textState.text=this.convertEscapeCharacters($gameMessage.allText()),this.newPage(this._textState),this.updatePlacement(),this.updateBackground(),this.open()},Window_Message.prototype.updatePlacement=function(){this._positionType=$gameMessage.positionType(),this.y=this._positionType*(Graphics.boxHeight-this.height)/2,this._goldWindow.y=this.y>0?0:Graphics.boxHeight-this._goldWindow.height},Window_Message.prototype.updateBackground=function(){this._background=$gameMessage.background(),this.setBackgroundType(this._background)},Window_Message.prototype.terminateMessage=function(){this.close(),this._goldWindow.close(),$gameMessage.clear()},Window_Message.prototype.updateWait=function(){return this._waitCount>0&&(this._waitCount--,!0)},Window_Message.prototype.updateLoading=function(){return!(!this._faceBitmap||this._faceBitmap.isReady()&&(this.drawMessageFace(),this._faceBitmap=null,1))},Window_Message.prototype.updateInput=function(){return!!this.isAnySubWindowActive()||!!this.pause&&(this.isTriggered()&&(Input.update(),this.pause=!1,this._textState||this.terminateMessage()),!0)},Window_Message.prototype.isAnySubWindowActive=function(){return this._choiceWindow.active||this._numberWindow.active||this._itemWindow.active},Window_Message.prototype.updateMessage=function(){if(this._textState){for(;!this.isEndOfText(this._textState);){if(this.needsNewPage(this._textState)&&this.newPage(this._textState),this.updateShowFast(),!this._showFast&&!this._lineShowFast&&this._textSpeedCount<this._textSpeed){this._textSpeedCount++
break}if(this._textSpeedCount=0,this.processCharacter(this._textState),!this._showFast&&!this._lineShowFast&&-1!==this._textSpeed)break
if(this.pause||this._waitCount>0)break}return this.isEndOfText(this._textState)&&this.onEndOfText(),!0}return!1},Window_Message.prototype.onEndOfText=function(){this.startInput()||(this._pauseSkip?this.terminateMessage():this.startPause()),this._textState=null},Window_Message.prototype.startInput=function(){return $gameMessage.isChoice()?(this._choiceWindow.start(),!0):$gameMessage.isNumberInput()?(this._numberWindow.start(),!0):!!$gameMessage.isItemChoice()&&(this._itemWindow.start(),!0)},Window_Message.prototype.isTriggered=function(){return Input.isRepeated("ok")||Input.isRepeated("cancel")||TouchInput.isRepeated()},Window_Message.prototype.doesContinue=function(){return $gameMessage.hasText()&&!$gameMessage.scrollMode()&&!this.areSettingsChanged()},Window_Message.prototype.areSettingsChanged=function(){return this._background!==$gameMessage.background()||this._positionType!==$gameMessage.positionType()},Window_Message.prototype.updateShowFast=function(){this.isTriggered()&&(this._showFast=!0)},Window_Message.prototype.newPage=function(t){this.contents.clear(),this.resetFontSettings(),this.clearFlags(),this.loadMessageFace(),t.x=this.newLineX(),t.y=0,t.left=this.newLineX(),t.height=this.calcTextHeight(t,!1)},Window_Message.prototype.loadMessageFace=function(){this._faceBitmap=ImageManager.reserveFace($gameMessage.faceName(),0,this._imageReservationId)},Window_Message.prototype.drawMessageFace=function(){this.drawFace($gameMessage.faceName(),$gameMessage.faceIndex(),0,0),ImageManager.releaseReservation(this._imageReservationId)},Window_Message.prototype.newLineX=function(){return""===$gameMessage.faceName()?0:168},Window_Message.prototype.processNewLine=function(t){this._lineShowFast=!1,Window_Base.prototype.processNewLine.call(this,t),this.needsNewPage(t)&&this.startPause()},Window_Message.prototype.processNewPage=function(t){Window_Base.prototype.processNewPage.call(this,t),"\n"===t.text[t.index]&&t.index++,t.y=this.contents.height,this.startPause()},Window_Message.prototype.isEndOfText=function(t){return t.index>=t.text.length},Window_Message.prototype.needsNewPage=function(t){return!this.isEndOfText(t)&&t.y+t.height>this.contents.height},Window_Message.prototype.processEscapeCharacter=function(t,e){switch(t){case"$":this._goldWindow.open()
break
case".":this.startWait(15)
break
case"|":this.startWait(60)
break
case"!":this.startPause()
break
case">":this._lineShowFast=!0
break
case"<":this._lineShowFast=!1
break
case"^":this._pauseSkip=!0
break
case"S":this._textSpeed=this.obtainEscapeParam(e)-1
break
default:Window_Base.prototype.processEscapeCharacter.call(this,t,e)}},Window_Message.prototype.startWait=function(t){this._waitCount=t},Window_Message.prototype.startPause=function(){this.startWait(10),this.pause=!0},Window_ScrollText.prototype=Object.create(Window_Base.prototype),Window_ScrollText.prototype.constructor=Window_ScrollText,Window_ScrollText.prototype.initialize=function(){const t=Graphics.boxWidth,e=Graphics.boxHeight
Window_Base.prototype.initialize.call(this,0,0,t,e),this.opacity=0,this.hide(),this._text="",this._allTextHeight=0},Window_ScrollText.prototype.update=function(){Window_Base.prototype.update.call(this),$gameMessage.scrollMode()&&(this._text&&this.updateMessage(),!this._text&&$gameMessage.hasText()&&this.startMessage())},Window_ScrollText.prototype.startMessage=function(){this._text=$gameMessage.allText(),this.refresh(),this.show()},Window_ScrollText.prototype.refresh=function(){const t={index:0}
t.text=this.convertEscapeCharacters(this._text),this.resetFontSettings(),this._allTextHeight=this.calcTextHeight(t,!0),this.createContents(),this.origin.y=-this.height,this.drawTextEx(this._text,this.textPadding(),1)},Window_ScrollText.prototype.contentsHeight=function(){return Math.max(this._allTextHeight,1)},Window_ScrollText.prototype.updateMessage=function(){this.origin.y+=this.scrollSpeed(),this.origin.y>=this.contents.height&&this.terminateMessage()},Window_ScrollText.prototype.scrollSpeed=function(){let t=$gameMessage.scrollSpeed()/2
return this.isFastForward()&&(t*=this.fastForwardRate()),t},Window_ScrollText.prototype.isFastForward=function(){return!$gameMessage.scrollNoFast()&&(Input.isPressed("ok")||Input.isPressed("shift")||TouchInput.isPressed())},Window_ScrollText.prototype.fastForwardRate=function(){return 3},Window_ScrollText.prototype.terminateMessage=function(){this._text=null,$gameMessage.clear(),this.hide()},Window_MapName.prototype=Object.create(Window_Base.prototype),Window_MapName.prototype.constructor=Window_MapName,Window_MapName.prototype.initialize=function(){const t=this.windowWidth(),e=this.windowHeight()
Window_Base.prototype.initialize.call(this,0,0,t,e),this.opacity=0,this.contentsOpacity=0,this._showCount=0,this.refresh()},Window_MapName.prototype.windowWidth=function(){return 360},Window_MapName.prototype.windowHeight=function(){return this.fittingHeight(1)},Window_MapName.prototype.update=function(){Window_Base.prototype.update.call(this),this._showCount>0&&$gameMap.isNameDisplayEnabled()?(this.updateFadeIn(),this._showCount--):this.updateFadeOut()},Window_MapName.prototype.updateFadeIn=function(){this.contentsOpacity+=16},Window_MapName.prototype.updateFadeOut=function(){this.contentsOpacity-=16},Window_MapName.prototype.open=function(){this.refresh(),this._showCount=150},Window_MapName.prototype.close=function(){this._showCount=0},Window_MapName.prototype.refresh=function(){if(this.contents.clear(),$gameMap.displayName()){const t=this.contentsWidth()
this.drawBackground(0,0,t,this.lineHeight()),this.drawText($gameMap.displayName(),0,0,t,"center")}},Window_MapName.prototype.drawBackground=function(t,e,i,o){const n=this.dimColor1(),s=this.dimColor2()
this.contents.gradientFillRect(t,e,i/2,o,s,n),this.contents.gradientFillRect(t+i/2,e,i/2,o,n,s)},Window_BattleLog.prototype=Object.create(Window_Selectable.prototype),Window_BattleLog.prototype.constructor=Window_BattleLog,Window_BattleLog.prototype.initialize=function(){const t=this.windowWidth(),e=this.windowHeight()
Window_Selectable.prototype.initialize.call(this,0,0,t,e),this.opacity=0,this._lines=[],this._methods=[],this._waitCount=0,this._waitMode="",this._baseLineStack=[],this._spriteset=null,this.createBackBitmap(),this.createBackSprite(),this.refresh()},Window_BattleLog.prototype.setSpriteset=function(t){this._spriteset=t},Window_BattleLog.prototype.windowWidth=function(){return Graphics.boxWidth},Window_BattleLog.prototype.windowHeight=function(){return this.fittingHeight(this.maxLines())},Window_BattleLog.prototype.maxLines=function(){return 10},Window_BattleLog.prototype.createBackBitmap=function(){this._backBitmap=new Bitmap(this.width,this.height)},Window_BattleLog.prototype.createBackSprite=function(){this._backSprite=new Sprite,this._backSprite.bitmap=this._backBitmap,this._backSprite.y=this.y,this.addChildToBack(this._backSprite)},Window_BattleLog.prototype.numLines=function(){return this._lines.length},Window_BattleLog.prototype.messageSpeed=function(){return 16},Window_BattleLog.prototype.isBusy=function(){return this._waitCount>0||this._waitMode||this._methods.length>0},Window_BattleLog.prototype.update=function(){this.updateWait()||this.callNextMethod()},Window_BattleLog.prototype.updateWait=function(){return this.updateWaitCount()||this.updateWaitMode()},Window_BattleLog.prototype.updateWaitCount=function(){return this._waitCount>0&&(this._waitCount-=this.isFastForward()?3:1,this._waitCount<0&&(this._waitCount=0),!0)},Window_BattleLog.prototype.updateWaitMode=function(){let t=!1
switch(this._waitMode){case"effect":t=this._spriteset.isEffecting()
break
case"movement":t=this._spriteset.isAnyoneMoving()}return t||(this._waitMode=""),t},Window_BattleLog.prototype.setWaitMode=function(t){this._waitMode=t},Window_BattleLog.prototype.callNextMethod=function(){if(this._methods.length>0){const t=this._methods.shift()
if(!t.name||!this[t.name])throw new Error("Method not found: "+t.name)
this[t.name].apply(this,t.params)}},Window_BattleLog.prototype.isFastForward=function(){return Input.isLongPressed("ok")||Input.isPressed("shift")||TouchInput.isLongPressed()},Window_BattleLog.prototype.push=function(t){const e=[].slice.call(arguments,1)
this._methods.push({name:t,params:e})},Window_BattleLog.prototype.clear=function(){this._lines=[],this._baseLineStack=[],this.refresh()},Window_BattleLog.prototype.wait=function(){this._waitCount=this.messageSpeed()},Window_BattleLog.prototype.waitForEffect=function(){this.setWaitMode("effect")},Window_BattleLog.prototype.waitForMovement=function(){this.setWaitMode("movement")},Window_BattleLog.prototype.addText=function(t){this._lines.push(t),this.refresh(),this.wait()},Window_BattleLog.prototype.pushBaseLine=function(){this._baseLineStack.push(this._lines.length)},Window_BattleLog.prototype.popBaseLine=function(){const t=this._baseLineStack.pop()
for(;this._lines.length>t;)this._lines.pop()},Window_BattleLog.prototype.waitForNewLine=function(){let t=0
this._baseLineStack.length>0&&(t=this._baseLineStack[this._baseLineStack.length-1]),this._lines.length>t&&this.wait()},Window_BattleLog.prototype.popupDamage=function(t){t.startDamagePopup()},Window_BattleLog.prototype.performActionStart=function(t,e){t.performActionStart(e)},Window_BattleLog.prototype.performAction=function(t,e){t.performAction(e)},Window_BattleLog.prototype.performActionEnd=function(t){t.performActionEnd()},Window_BattleLog.prototype.performDamage=function(t){t.performDamage()},Window_BattleLog.prototype.performMiss=function(t){t.performMiss()},Window_BattleLog.prototype.performRecovery=function(t){t.performRecovery()},Window_BattleLog.prototype.performEvasion=function(t){t.performEvasion()},Window_BattleLog.prototype.performMagicEvasion=function(t){t.performMagicEvasion()},Window_BattleLog.prototype.performCounter=function(t){t.performCounter()},Window_BattleLog.prototype.performReflection=function(t){t.performReflection()},Window_BattleLog.prototype.performSubstitute=function(t,e){t.performSubstitute(e)},Window_BattleLog.prototype.performCollapse=function(t){t.performCollapse()},Window_BattleLog.prototype.showAnimation=function(t,e,i){i<0?this.showAttackAnimation(t,e):this.showNormalAnimation(e,i)},Window_BattleLog.prototype.showAttackAnimation=function(t,e){t.isActor()?this.showActorAttackAnimation(t,e):this.showEnemyAttackAnimation(t,e)},Window_BattleLog.prototype.showActorAttackAnimation=function(t,e){this.showNormalAnimation(e,t.attackAnimationId1(),!1),this.showNormalAnimation(e,t.attackAnimationId2(),!0)},Window_BattleLog.prototype.showEnemyAttackAnimation=function(t,e){SoundManager.playEnemyAttack()},Window_BattleLog.prototype.showNormalAnimation=function(t,e,i){const o=void 0
if($dataAnimations[e]){let o=this.animationBaseDelay()
const n=this.animationNextDelay()
t.forEach((function(t){t.startAnimation(e,i,o),o+=n}))}},Window_BattleLog.prototype.animationBaseDelay=function(){return 8},Window_BattleLog.prototype.animationNextDelay=function(){return 12},Window_BattleLog.prototype.refresh=function(){this.drawBackground(),this.contents.clear()
for(let t=0;t<this._lines.length;t++)this.drawLineText(t)},Window_BattleLog.prototype.drawBackground=function(){const t=this.backRect(),e=this.backColor()
this._backBitmap.clear(),this._backBitmap.paintOpacity=this.backPaintOpacity(),this._backBitmap.fillRect(t.x,t.y,t.width,t.height,e),this._backBitmap.paintOpacity=255},Window_BattleLog.prototype.backRect=function(){return{x:0,y:this.padding,width:this.width,height:this.numLines()*this.lineHeight()}},Window_BattleLog.prototype.backColor=function(){return"#000000"},Window_BattleLog.prototype.backPaintOpacity=function(){return 64},Window_BattleLog.prototype.drawLineText=function(t){const e=this.itemRectForText(t)
this.contents.clearRect(e.x,e.y,e.width,e.height),this.drawTextEx(this._lines[t],e.x,e.y,e.width)},Window_BattleLog.prototype.startTurn=function(){this.push("wait")},Window_BattleLog.prototype.startAction=function(t,e,i){const o=e.item()
this.push("performActionStart",t,e),this.push("waitForMovement"),this.push("performAction",t,e),this.push("showAnimation",t,i.clone(),o.animationId),this.displayAction(t,o)},Window_BattleLog.prototype.endAction=function(t){this.push("waitForNewLine"),this.push("clear"),this.push("performActionEnd",t)},Window_BattleLog.prototype.displayCurrentState=function(t){const e=t.mostImportantStateText()
e&&(this.push("addText",t.name()+e),this.push("wait"),this.push("clear"))},Window_BattleLog.prototype.displayRegeneration=function(t){this.push("popupDamage",t)},Window_BattleLog.prototype.displayAction=function(t,e){const i=this._methods.length
DataManager.isSkill(e)?(e.message1&&this.push("addText",t.name()+e.message1.format(e.name)),e.message2&&this.push("addText",e.message2.format(e.name))):this.push("addText",TextManager.useItem.format(t.name(),e.name)),this._methods.length===i&&this.push("wait")},Window_BattleLog.prototype.displayCounter=function(t){this.push("performCounter",t),this.push("addText",TextManager.counterAttack.format(t.name()))},Window_BattleLog.prototype.displayReflection=function(t){this.push("performReflection",t),this.push("addText",TextManager.magicReflection.format(t.name()))},Window_BattleLog.prototype.displaySubstitute=function(t,e){const i=t.name()
this.push("performSubstitute",t,e),this.push("addText",TextManager.substitute.format(i,e.name()))},Window_BattleLog.prototype.displayActionResults=function(t,e){e.result().used&&(this.push("pushBaseLine"),this.displayCritical(e),this.push("popupDamage",e),this.push("popupDamage",t),this.displayDamage(e),this.displayAffectedStatus(e),this.displayFailure(e),this.push("waitForNewLine"),this.push("popBaseLine"))},Window_BattleLog.prototype.displayFailure=function(t){t.result().isHit()&&!t.result().success&&this.push("addText",TextManager.actionFailure.format(t.name()))},Window_BattleLog.prototype.displayCritical=function(t){t.result().critical&&(t.isActor()?this.push("addText",TextManager.criticalToActor):this.push("addText",TextManager.criticalToEnemy))},Window_BattleLog.prototype.displayDamage=function(t){t.result().missed?this.displayMiss(t):t.result().evaded?this.displayEvasion(t):(this.displayHpDamage(t),this.displayMpDamage(t),this.displayTpDamage(t))},Window_BattleLog.prototype.displayMiss=function(t){let e
t.result().physical?(e=t.isActor()?TextManager.actorNoHit:TextManager.enemyNoHit,this.push("performMiss",t)):e=TextManager.actionFailure,this.push("addText",e.format(t.name()))},Window_BattleLog.prototype.displayEvasion=function(t){let e
t.result().physical?(e=TextManager.evasion,this.push("performEvasion",t)):(e=TextManager.magicEvasion,this.push("performMagicEvasion",t)),this.push("addText",e.format(t.name()))},Window_BattleLog.prototype.displayHpDamage=function(t){t.result().hpAffected&&(t.result().hpDamage>0&&!t.result().drain&&this.push("performDamage",t),t.result().hpDamage<0&&this.push("performRecovery",t),this.push("addText",this.makeHpDamageText(t)))},Window_BattleLog.prototype.displayMpDamage=function(t){t.isAlive()&&0!==t.result().mpDamage&&(t.result().mpDamage<0&&this.push("performRecovery",t),this.push("addText",this.makeMpDamageText(t)))},Window_BattleLog.prototype.displayTpDamage=function(t){t.isAlive()&&0!==t.result().tpDamage&&(t.result().tpDamage<0&&this.push("performRecovery",t),this.push("addText",this.makeTpDamageText(t)))},Window_BattleLog.prototype.displayAffectedStatus=function(t){t.result().isStatusAffected()&&(this.push("pushBaseLine"),this.displayChangedStates(t),this.displayChangedBuffs(t),this.push("waitForNewLine"),this.push("popBaseLine"))},Window_BattleLog.prototype.displayAutoAffectedStatus=function(t){t.result().isStatusAffected()&&(this.displayAffectedStatus(t,null),this.push("clear"))},Window_BattleLog.prototype.displayChangedStates=function(t){this.displayAddedStates(t),this.displayRemovedStates(t)},Window_BattleLog.prototype.displayAddedStates=function(t){t.result().addedStateObjects().forEach((function(e){const i=t.isActor()?e.message1:e.message2
e.id===t.deathStateId()&&this.push("performCollapse",t),i&&(this.push("popBaseLine"),this.push("pushBaseLine"),this.push("addText",t.name()+i),this.push("waitForEffect"))}),this)},Window_BattleLog.prototype.displayRemovedStates=function(t){t.result().removedStateObjects().forEach((function(e){e.message4&&(this.push("popBaseLine"),this.push("pushBaseLine"),this.push("addText",t.name()+e.message4))}),this)},Window_BattleLog.prototype.displayChangedBuffs=function(t){const e=t.result()
this.displayBuffs(t,e.addedBuffs,TextManager.buffAdd),this.displayBuffs(t,e.addedDebuffs,TextManager.debuffAdd),this.displayBuffs(t,e.removedBuffs,TextManager.buffRemove)},Window_BattleLog.prototype.displayBuffs=function(t,e,i){e.forEach((function(e){this.push("popBaseLine"),this.push("pushBaseLine"),this.push("addText",i.format(t.name(),TextManager.param(e)))}),this)},Window_BattleLog.prototype.makeHpDamageText=function(t){const e=t.result(),i=e.hpDamage,o=t.isActor()
let n
return i>0&&e.drain?(n=o?TextManager.actorDrain:TextManager.enemyDrain,n.format(t.name(),TextManager.hp,i)):i>0?(n=o?TextManager.actorDamage:TextManager.enemyDamage,n.format(t.name(),i)):i<0?(n=o?TextManager.actorRecovery:TextManager.enemyRecovery,n.format(t.name(),TextManager.hp,-i)):(n=o?TextManager.actorNoDamage:TextManager.enemyNoDamage,n.format(t.name()))},Window_BattleLog.prototype.makeMpDamageText=function(t){const e=t.result(),i=e.mpDamage,o=t.isActor()
let n
return i>0&&e.drain?(n=o?TextManager.actorDrain:TextManager.enemyDrain,n.format(t.name(),TextManager.mp,i)):i>0?(n=o?TextManager.actorLoss:TextManager.enemyLoss,n.format(t.name(),TextManager.mp,i)):i<0?(n=o?TextManager.actorRecovery:TextManager.enemyRecovery,n.format(t.name(),TextManager.mp,-i)):""},Window_BattleLog.prototype.makeTpDamageText=function(t){const e=void 0,i=t.result().tpDamage,o=t.isActor()
let n
return i>0?(n=o?TextManager.actorLoss:TextManager.enemyLoss,n.format(t.name(),TextManager.tp,i)):i<0?(n=o?TextManager.actorGain:TextManager.enemyGain,n.format(t.name(),TextManager.tp,-i)):""},Window_PartyCommand.prototype=Object.create(Window_Command.prototype),Window_PartyCommand.prototype.constructor=Window_PartyCommand,Window_PartyCommand.prototype.initialize=function(){const t=Graphics.boxHeight-this.windowHeight()
Window_Command.prototype.initialize.call(this,0,t),this.openness=0,this.deactivate()},Window_PartyCommand.prototype.windowWidth=function(){return 192},Window_PartyCommand.prototype.numVisibleRows=function(){return 4},Window_PartyCommand.prototype.makeCommandList=function(){this.addCommand(TextManager.fight,"fight"),this.addCommand(TextManager.escape,"escape",BattleManager.canEscape())},Window_PartyCommand.prototype.setup=function(){this.clearCommandList(),this.makeCommandList(),this.refresh(),this.select(0),this.activate(),this.open()},Window_ActorCommand.prototype=Object.create(Window_Command.prototype),Window_ActorCommand.prototype.constructor=Window_ActorCommand,Window_ActorCommand.prototype.initialize=function(){const t=Graphics.boxHeight-this.windowHeight()
Window_Command.prototype.initialize.call(this,0,t),this.openness=0,this.deactivate(),this._actor=null},Window_ActorCommand.prototype.windowWidth=function(){return 192},Window_ActorCommand.prototype.numVisibleRows=function(){return 4},Window_ActorCommand.prototype.makeCommandList=function(){this._actor&&(this.addAttackCommand(),this.addSkillCommands(),this.addGuardCommand(),this.addItemCommand())},Window_ActorCommand.prototype.addAttackCommand=function(){this.addCommand(TextManager.attack,"attack",this._actor.canAttack())},Window_ActorCommand.prototype.addSkillCommands=function(){const t=this._actor.addedSkillTypes()
t.sort((function(t,e){return t-e})),t.forEach((function(t){const e=$dataSystem.skillTypes[t]
this.addCommand(e,"skill",!0,t)}),this)},Window_ActorCommand.prototype.addGuardCommand=function(){this.addCommand(TextManager.guard,"guard",this._actor.canGuard())},Window_ActorCommand.prototype.addItemCommand=function(){this.addCommand(TextManager.item,"item")},Window_ActorCommand.prototype.setup=function(t){this._actor=t,this.clearCommandList(),this.makeCommandList(),this.refresh(),this.selectLast(),this.activate(),this.open()},Window_ActorCommand.prototype.processOk=function(){this._actor&&(ConfigManager.commandRemember?this._actor.setLastCommandSymbol(this.currentSymbol()):this._actor.setLastCommandSymbol("")),Window_Command.prototype.processOk.call(this)},Window_ActorCommand.prototype.selectLast=function(){if(this.select(0),this._actor&&ConfigManager.commandRemember){const t=this._actor.lastCommandSymbol()
if(this.selectSymbol(t),"skill"===t){const t=this._actor.lastBattleSkill()
t&&this.selectExt(t.stypeId)}}},Window_BattleStatus.prototype=Object.create(Window_Selectable.prototype),Window_BattleStatus.prototype.constructor=Window_BattleStatus
Window_BattleStatus.prototype.initialize=function(){const t=this.windowWidth(),e=this.windowHeight(),i=Graphics.boxWidth-t,o=Graphics.boxHeight-e
Window_Selectable.prototype.initialize.call(this,i,o,t,e),this.refresh(),this.openness=0},Window_BattleStatus.prototype.windowWidth=function(){return Graphics.boxWidth-192},Window_BattleStatus.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_BattleStatus.prototype.numVisibleRows=function(){return 4},Window_BattleStatus.prototype.maxItems=function(){return $gameParty.battleMembers().length},Window_BattleStatus.prototype.refresh=function(){this.contents.clear(),this.drawAllItems()},Window_BattleStatus.prototype.drawItem=function(t){const e=$gameParty.battleMembers()[t]
this.drawBasicArea(this.basicAreaRect(t),e),this.drawGaugeArea(this.gaugeAreaRect(t),e)},Window_BattleStatus.prototype.basicAreaRect=function(t){const e=this.itemRectForText(t)
return e.width-=this.gaugeAreaWidth()+15,e},Window_BattleStatus.prototype.gaugeAreaRect=function(t){const e=this.itemRectForText(t)
return e.x+=e.width-this.gaugeAreaWidth(),e.width=this.gaugeAreaWidth(),e},Window_BattleStatus.prototype.gaugeAreaWidth=function(){return 330},Window_BattleStatus.prototype.drawBasicArea=function(t,e){this.drawActorName(e,t.x+0,t.y,150),this.drawActorIcons(e,t.x+156,t.y,t.width-156)},Window_BattleStatus.prototype.drawGaugeArea=function(t,e){$dataSystem.optDisplayTp?this.drawGaugeAreaWithTp(t,e):this.drawGaugeAreaWithoutTp(t,e)},Window_BattleStatus.prototype.drawGaugeAreaWithTp=function(t,e){this.drawActorHp(e,t.x+0,t.y,108),this.drawActorMp(e,t.x+123,t.y,96),this.drawActorTp(e,t.x+234,t.y,96)},Window_BattleStatus.prototype.drawGaugeAreaWithoutTp=function(t,e){this.drawActorHp(e,t.x+0,t.y,201),this.drawActorMp(e,t.x+216,t.y,114)},Window_BattleActor.prototype=Object.create(Window_BattleStatus.prototype),Window_BattleActor.prototype.constructor=Window_BattleActor,Window_BattleActor.prototype.initialize=function(t,e){Window_BattleStatus.prototype.initialize.call(this),this.x=t,this.y=e,this.openness=255,this.hide()},Window_BattleActor.prototype.show=function(){this.select(0),Window_BattleStatus.prototype.show.call(this)},Window_BattleActor.prototype.hide=function(){Window_BattleStatus.prototype.hide.call(this),$gameParty.select(null)},Window_BattleActor.prototype.select=function(t){Window_BattleStatus.prototype.select.call(this,t),$gameParty.select(this.actor())},Window_BattleActor.prototype.actor=function(){return $gameParty.members()[this.index()]},Window_BattleEnemy.prototype=Object.create(Window_Selectable.prototype),Window_BattleEnemy.prototype.constructor=Window_BattleEnemy,Window_BattleEnemy.prototype.initialize=function(t,e){this._enemies=[]
const i=this.windowWidth(),o=this.windowHeight()
Window_Selectable.prototype.initialize.call(this,t,e,i,o),this.refresh(),this.hide()},Window_BattleEnemy.prototype.windowWidth=function(){return Graphics.boxWidth-192},Window_BattleEnemy.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_BattleEnemy.prototype.numVisibleRows=function(){return 4},Window_BattleEnemy.prototype.maxCols=function(){return 2},Window_BattleEnemy.prototype.maxItems=function(){return this._enemies.length},Window_BattleEnemy.prototype.enemy=function(){return this._enemies[this.index()]},Window_BattleEnemy.prototype.enemyIndex=function(){const t=this.enemy()
return t?t.index():-1},Window_BattleEnemy.prototype.drawItem=function(t){this.resetTextColor()
const e=this._enemies[t].name(),i=this.itemRectForText(t)
this.drawText(e,i.x,i.y,i.width)},Window_BattleEnemy.prototype.show=function(){this.refresh(),this.select(0),Window_Selectable.prototype.show.call(this)},Window_BattleEnemy.prototype.hide=function(){Window_Selectable.prototype.hide.call(this),$gameTroop.select(null)},Window_BattleEnemy.prototype.refresh=function(){this._enemies=$gameTroop.aliveMembers(),Window_Selectable.prototype.refresh.call(this)},Window_BattleEnemy.prototype.select=function(t){Window_Selectable.prototype.select.call(this,t),$gameTroop.select(this.enemy())},Window_BattleSkill.prototype=Object.create(Window_SkillList.prototype),Window_BattleSkill.prototype.constructor=Window_BattleSkill,Window_BattleSkill.prototype.initialize=function(t,e,i,o){Window_SkillList.prototype.initialize.call(this,t,e,i,o),this.hide()},Window_BattleSkill.prototype.show=function(){this.selectLast(),this.showHelpWindow(),Window_SkillList.prototype.show.call(this)},Window_BattleSkill.prototype.hide=function(){this.hideHelpWindow(),Window_SkillList.prototype.hide.call(this)},Window_BattleItem.prototype=Object.create(Window_ItemList.prototype),Window_BattleItem.prototype.constructor=Window_BattleItem,Window_BattleItem.prototype.initialize=function(t,e,i,o){Window_ItemList.prototype.initialize.call(this,t,e,i,o),this.hide()},Window_BattleItem.prototype.includes=function(t){return $gameParty.canUse(t)},Window_BattleItem.prototype.show=function(){this.selectLast(),this.showHelpWindow(),Window_ItemList.prototype.show.call(this)},Window_BattleItem.prototype.hide=function(){this.hideHelpWindow(),Window_ItemList.prototype.hide.call(this)},Window_TitleCommand.prototype=Object.create(Window_Command.prototype),Window_TitleCommand.prototype.constructor=Window_TitleCommand,Window_TitleCommand.prototype.initialize=function(){Window_Command.prototype.initialize.call(this,0,0),this.updatePlacement(),this.openness=0,this.selectLast()},Window_TitleCommand._lastCommandSymbol=null,Window_TitleCommand.initCommandPosition=function(){this._lastCommandSymbol=null},Window_TitleCommand.prototype.windowWidth=function(){return 240},Window_TitleCommand.prototype.updatePlacement=function(){this.x=(Graphics.boxWidth-this.width)/2,this.y=Graphics.boxHeight-this.height-96},Window_TitleCommand.prototype.makeCommandList=function(){this.addCommand(TextManager.newGame,"newGame"),this.addCommand(TextManager.continue_,"continue",this.isContinueEnabled()),this.addCommand(TextManager.options,"options")},Window_TitleCommand.prototype.isContinueEnabled=function(){return DataManager.isAnySavefileExists()},Window_TitleCommand.prototype.processOk=function(){Window_TitleCommand._lastCommandSymbol=this.currentSymbol(),Window_Command.prototype.processOk.call(this)},Window_TitleCommand.prototype.selectLast=function(){Window_TitleCommand._lastCommandSymbol?this.selectSymbol(Window_TitleCommand._lastCommandSymbol):this.isContinueEnabled()&&this.selectSymbol("continue")},Window_GameEnd.prototype=Object.create(Window_Command.prototype),Window_GameEnd.prototype.constructor=Window_GameEnd,Window_GameEnd.prototype.initialize=function(){Window_Command.prototype.initialize.call(this,0,0),this.updatePlacement(),this.openness=0,this.open()},Window_GameEnd.prototype.windowWidth=function(){return 240},Window_GameEnd.prototype.updatePlacement=function(){this.x=(Graphics.boxWidth-this.width)/2,this.y=(Graphics.boxHeight-this.height)/2},Window_GameEnd.prototype.makeCommandList=function(){this.addCommand(TextManager.toTitle,"toTitle"),this.addCommand(TextManager.cancel,"cancel")},Window_DebugRange.prototype=Object.create(Window_Selectable.prototype),Window_DebugRange.prototype.constructor=Window_DebugRange,Window_DebugRange.lastTopRow=0,Window_DebugRange.lastIndex=0,Window_DebugRange.prototype.initialize=function(t,e){this._maxSwitches=Math.ceil(($dataSystem.switches.length-1)/10),this._maxVariables=Math.ceil(($dataSystem.variables.length-1)/10)
const i=this.windowWidth(),o=this.windowHeight()
Window_Selectable.prototype.initialize.call(this,t,e,i,o),this.refresh(),this.setTopRow(Window_DebugRange.lastTopRow),this.select(Window_DebugRange.lastIndex),this.activate()},Window_DebugRange.prototype.windowWidth=function(){return 246},Window_DebugRange.prototype.windowHeight=function(){return Graphics.boxHeight},Window_DebugRange.prototype.maxItems=function(){return this._maxSwitches+this._maxVariables},Window_DebugRange.prototype.update=function(){Window_Selectable.prototype.update.call(this),this._editWindow&&(this._editWindow.setMode(this.mode()),this._editWindow.setTopId(this.topId()))},Window_DebugRange.prototype.mode=function(){return this.index()<this._maxSwitches?"switch":"variable"},Window_DebugRange.prototype.topId=function(){const t=this.index()
return t<this._maxSwitches?10*t+1:10*(t-this._maxSwitches)+1},Window_DebugRange.prototype.refresh=function(){this.createContents(),this.drawAllItems()},Window_DebugRange.prototype.drawItem=function(t){const e=this.itemRectForText(t)
let i,o
t<this._maxSwitches?(i=10*t+1,o="S"):(i=10*(t-this._maxSwitches)+1,o="V")
const n=i+9
o+=" ["+i.padZero(4)+"-"+n.padZero(4)+"]",this.drawText(o,e.x,e.y,e.width)},Window_DebugRange.prototype.isCancelTriggered=function(){return Window_Selectable.prototype.isCancelTriggered()||Input.isTriggered("debug")},Window_DebugRange.prototype.processCancel=function(){Window_Selectable.prototype.processCancel.call(this),Window_DebugRange.lastTopRow=this.topRow(),Window_DebugRange.lastIndex=this.index()},Window_DebugRange.prototype.setEditWindow=function(t){this._editWindow=t},Window_DebugEdit.prototype=Object.create(Window_Selectable.prototype),Window_DebugEdit.prototype.constructor=Window_DebugEdit,Window_DebugEdit.prototype.initialize=function(t,e,i){const o=this.fittingHeight(10)
Window_Selectable.prototype.initialize.call(this,t,e,i,o),this._mode="switch",this._topId=1,this.refresh()},Window_DebugEdit.prototype.maxItems=function(){return 10},Window_DebugEdit.prototype.refresh=function(){this.contents.clear(),this.drawAllItems()},Window_DebugEdit.prototype.drawItem=function(t){const e=this._topId+t,i=e.padZero(4)+":",o=this.textWidth(i),n=this.textWidth("-00000000"),s=this.itemName(e),a=this.itemStatus(e),r=this.itemRectForText(t)
this.resetTextColor(),this.drawText(i,r.x,r.y,r.width),r.x+=o,r.width-=o+n,this.drawText(s,r.x,r.y,r.width),this.drawText(a,r.x+r.width,r.y,n,"right")},Window_DebugEdit.prototype.itemName=function(t){return"switch"===this._mode?$dataSystem.switches[t]:$dataSystem.variables[t]},Window_DebugEdit.prototype.itemStatus=function(t){return"switch"===this._mode?$gameSwitches.value(t)?"[ON]":"[OFF]":String($gameVariables.value(t))},Window_DebugEdit.prototype.setMode=function(t){this._mode!==t&&(this._mode=t,this.refresh())},Window_DebugEdit.prototype.setTopId=function(t){this._topId!==t&&(this._topId=t,this.refresh())},Window_DebugEdit.prototype.currentId=function(){return this._topId+this.index()},Window_DebugEdit.prototype.update=function(){Window_Selectable.prototype.update.call(this),this.active&&("switch"===this._mode?this.updateSwitch():this.updateVariable())},Window_DebugEdit.prototype.updateSwitch=function(){if(Input.isRepeated("ok")){const t=this.currentId()
SoundManager.playCursor(),$gameSwitches.setValue(t,!$gameSwitches.value(t)),this.redrawCurrentItem()}},Window_DebugEdit.prototype.updateVariable=function(){const t=this.currentId()
let e=$gameVariables.value(t)
"number"==typeof e&&(Input.isRepeated("right")&&e++,Input.isRepeated("left")&&e--,Input.isRepeated("pagedown")&&(e+=10),Input.isRepeated("pageup")&&(e-=10),$gameVariables.value(t)!==e&&($gameVariables.setValue(t,e),SoundManager.playCursor(),this.redrawCurrentItem()))}
