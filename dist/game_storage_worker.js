/*!
 * Part of RPG Maker MV CoreScript
 * @link https://github.com/thinknathan/corescript/blob/master/CONTRIBUTORS.md
 * @license https://github.com/thinknathan/corescript/blob/master/LICENSE 
 */
"use strict";(()=>{var E=Uint8Array,F=Uint16Array,ur=Uint32Array,fr=new E([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),lr=new E([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Sr=new E([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),jr=function(r,t){for(var e=new F(31),n=0;n<31;++n)e[n]=t+=1<<r[n-1];for(var a=new ur(e[30]),n=1;n<30;++n)for(var s=e[n];s<e[n+1];++s)a[s]=s-e[n]<<5|n;return[e,a]},Vr=jr(fr,2),Yr=Vr[0],Ar=Vr[1];Yr[28]=258,Ar[258]=28;var $r=jr(lr,0),ft=$r[0],Wr=$r[1],Mr=new F(32768);for(v=0;v<32768;++v)V=(v&43690)>>>1|(v&21845)<<1,V=(V&52428)>>>2|(V&13107)<<2,V=(V&61680)>>>4|(V&3855)<<4,Mr[v]=((V&65280)>>>8|(V&255)<<8)>>>1;var V,v,j=function(r,t,e){for(var n=r.length,a=0,s=new F(t);a<n;++a)r[a]&&++s[r[a]-1];var f=new F(t);for(a=0;a<t;++a)f[a]=f[a-1]+s[a-1]<<1;var l;if(e){l=new F(1<<t);var u=15-t;for(a=0;a<n;++a)if(r[a])for(var o=a<<4|r[a],i=t-r[a],p=f[r[a]-1]++<<i,h=p|(1<<i)-1;p<=h;++p)l[Mr[p]>>>u]=o}else for(l=new F(n),a=0;a<n;++a)r[a]&&(l[a]=Mr[f[r[a]-1]++]>>>15-r[a]);return l},q=new E(288);for(v=0;v<144;++v)q[v]=8;var v;for(v=144;v<256;++v)q[v]=9;var v;for(v=256;v<280;++v)q[v]=7;var v;for(v=280;v<288;++v)q[v]=8;var v,or=new E(32);for(v=0;v<32;++v)or[v]=5;var v,lt=j(q,9,0),ct=j(q,9,1),ht=j(or,5,0),vt=j(or,5,1),zr=function(r){for(var t=r[0],e=1;e<r.length;++e)r[e]>t&&(t=r[e]);return t},N=function(r,t,e){var n=t/8|0;return(r[n]|r[n+1]<<8)>>(t&7)&e},Er=function(r,t){var e=t/8|0;return(r[e]|r[e+1]<<8|r[e+2]<<16)>>(t&7)},Dr=function(r){return(r+7)/8|0},cr=function(r,t,e){(t==null||t<0)&&(t=0),(e==null||e>r.length)&&(e=r.length);var n=new(r.BYTES_PER_ELEMENT==2?F:r.BYTES_PER_ELEMENT==4?ur:E)(e-t);return n.set(r.subarray(t,e)),n};var pt=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],$=function(r,t,e){var n=new Error(t||pt[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,$),!e)throw n;return n},gt=function(r,t,e){var n=r.length;if(!n||e&&e.f&&!e.l)return t||new E(0);var a=!t||e,s=!e||e.i;e||(e={}),t||(t=new E(n*3));var f=function(sr){var nr=t.length;if(sr>nr){var rr=new E(Math.max(nr*2,sr));rr.set(t),t=rr}},l=e.f||0,u=e.p||0,o=e.b||0,i=e.l,p=e.d,h=e.m,g=e.n,M=n*8;do{if(!i){l=N(r,u,1);var d=N(r,u+1,3);if(u+=3,d)if(d==1)i=ct,p=vt,h=9,g=5;else if(d==2){var W=N(r,u,31)+257,R=N(r,u+10,15)+4,P=W+N(r,u+5,31)+1;u+=14;for(var z=new E(P),m=new E(19),c=0;c<R;++c)m[Sr[c]]=N(r,u+c*3,7);u+=R*3;for(var H=zr(m),T=(1<<H)-1,_=j(m,H,1),c=0;c<P;){var k=_[N(r,u,T)];u+=k&15;var y=k>>>4;if(y<16)z[c++]=y;else{var L=0,S=0;for(y==16?(S=3+N(r,u,3),u+=2,L=z[c-1]):y==17?(S=3+N(r,u,7),u+=3):y==18&&(S=11+N(r,u,127),u+=7);S--;)z[c++]=L}}var U=z.subarray(0,W),w=z.subarray(W);h=zr(U),g=zr(w),i=j(U,h,1),p=j(w,g,1)}else $(1);else{var y=Dr(u)+4,B=r[y-4]|r[y-3]<<8,C=y+B;if(C>n){s&&$(0);break}a&&f(o+B),t.set(r.subarray(y,C),o),e.b=o+=B,e.p=u=C*8,e.f=l;continue}if(u>M){s&&$(0);break}}a&&f(o+131072);for(var x=(1<<h)-1,I=(1<<g)-1,G=u;;G=u){var L=i[Er(r,u)&x],K=L>>>4;if(u+=L&15,u>M){s&&$(0);break}if(L||$(2),K<256)t[o++]=K;else if(K==256){G=u,i=null;break}else{var O=K-254;if(K>264){var c=K-257,Z=fr[c];O=N(r,u,(1<<Z)-1)+Yr[c],u+=Z}var b=p[Er(r,u)&I],D=b>>>4;b||$(3),u+=b&15;var w=ft[D];if(D>3){var Z=lr[D];w+=Er(r,u)&(1<<Z)-1,u+=Z}if(u>M){s&&$(0);break}a&&f(o+131072);for(var A=o+O;o<A;o+=4)t[o]=t[o-w],t[o+1]=t[o+1-w],t[o+2]=t[o+2-w],t[o+3]=t[o+3-w];o=A}}e.l=i,e.p=G,e.b=o,e.f=l,i&&(l=1,e.m=h,e.d=p,e.n=g)}while(!l);return o==t.length?t:cr(t,0,o)},Y=function(r,t,e){e<<=t&7;var n=t/8|0;r[n]|=e,r[n+1]|=e>>>8},ar=function(r,t,e){e<<=t&7;var n=t/8|0;r[n]|=e,r[n+1]|=e>>>8,r[n+2]|=e>>>16},kr=function(r,t){for(var e=[],n=0;n<r.length;++n)r[n]&&e.push({s:n,f:r[n]});var a=e.length,s=e.slice();if(!a)return[Fr,0];if(a==1){var f=new E(e[0].s+1);return f[e[0].s]=1,[f,1]}e.sort(function(P,z){return P.f-z.f}),e.push({s:-1,f:25001});var l=e[0],u=e[1],o=0,i=1,p=2;for(e[0]={s:-1,f:l.f+u.f,l,r:u};i!=a-1;)l=e[e[o].f<e[p].f?o++:p++],u=e[o!=i&&e[o].f<e[p].f?o++:p++],e[i++]={s:-1,f:l.f+u.f,l,r:u};for(var h=s[0].s,n=1;n<a;++n)s[n].s>h&&(h=s[n].s);var g=new F(h+1),M=Cr(e[i-1],g,0);if(M>t){var n=0,d=0,y=M-t,B=1<<y;for(s.sort(function(z,m){return g[m.s]-g[z.s]||z.f-m.f});n<a;++n){var C=s[n].s;if(g[C]>t)d+=B-(1<<M-g[C]),g[C]=t;else break}for(d>>>=y;d>0;){var W=s[n].s;g[W]<t?d-=1<<t-g[W]++-1:++n}for(;n>=0&&d;--n){var R=s[n].s;g[R]==t&&(--g[R],++d)}M=t}return[new E(g),M]},Cr=function(r,t,e){return r.s==-1?Math.max(Cr(r.l,t,e+1),Cr(r.r,t,e+1)):t[r.s]=e},Hr=function(r){for(var t=r.length;t&&!r[--t];);for(var e=new F(++t),n=0,a=r[0],s=1,f=function(u){e[n++]=u},l=1;l<=t;++l)if(r[l]==a&&l!=t)++s;else{if(!a&&s>2){for(;s>138;s-=138)f(32754);s>2&&(f(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(f(a),--s;s>6;s-=6)f(8304);s>2&&(f(s-3<<5|8208),s=0)}for(;s--;)f(a);s=1,a=r[l]}return[e.subarray(0,n),t]},ir=function(r,t){for(var e=0,n=0;n<t.length;++n)e+=r[n]*t[n];return e},Tr=function(r,t,e){var n=e.length,a=Dr(t+2);r[a]=n&255,r[a+1]=n>>>8,r[a+2]=r[a]^255,r[a+3]=r[a+1]^255;for(var s=0;s<n;++s)r[a+s+4]=e[s];return(a+4+n)*8},Kr=function(r,t,e,n,a,s,f,l,u,o,i){Y(t,i++,e),++a[256];for(var p=kr(a,15),h=p[0],g=p[1],M=kr(s,15),d=M[0],y=M[1],B=Hr(h),C=B[0],W=B[1],R=Hr(d),P=R[0],z=R[1],m=new F(19),c=0;c<C.length;++c)m[C[c]&31]++;for(var c=0;c<P.length;++c)m[P[c]&31]++;for(var H=kr(m,7),T=H[0],_=H[1],k=19;k>4&&!T[Sr[k-1]];--k);var L=o+5<<3,S=ir(a,q)+ir(s,or)+f,U=ir(a,h)+ir(s,d)+f+14+3*k+ir(m,T)+(2*m[16]+3*m[17]+7*m[18]);if(L<=S&&L<=U)return Tr(t,i,r.subarray(u,u+o));var w,x,I,G;if(Y(t,i,1+(U<S)),i+=2,U<S){w=j(h,g,0),x=h,I=j(d,y,0),G=d;var K=j(T,_,0);Y(t,i,W-257),Y(t,i+5,z-1),Y(t,i+10,k-4),i+=14;for(var c=0;c<k;++c)Y(t,i+3*c,T[Sr[c]]);i+=3*k;for(var O=[C,P],Z=0;Z<2;++Z)for(var b=O[Z],c=0;c<b.length;++c){var D=b[c]&31;Y(t,i,K[D]),i+=T[D],D>15&&(Y(t,i,b[c]>>>5&127),i+=b[c]>>>12)}}else w=lt,x=q,I=ht,G=or;for(var c=0;c<l;++c)if(n[c]>255){var D=n[c]>>>18&31;ar(t,i,w[D+257]),i+=x[D+257],D>7&&(Y(t,i,n[c]>>>23&31),i+=fr[D]);var A=n[c]&31;ar(t,i,I[A]),i+=G[A],A>3&&(ar(t,i,n[c]>>>5&8191),i+=lr[A])}else ar(t,i,w[n[c]]),i+=x[n[c]];return ar(t,i,w[256]),i+x[256]},yt=new ur([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Fr=new E(0),mt=function(r,t,e,n,a,s){var f=r.length,l=new E(n+f+5*(1+Math.ceil(f/7e3))+a),u=l.subarray(n,l.length-a),o=0;if(!t||f<8)for(var i=0;i<=f;i+=65535){var p=i+65535;p>=f&&(u[o>>3]=s),o=Tr(u,o+1,r.subarray(i,p))}else{for(var h=yt[t-1],g=h>>>13,M=h&8191,d=(1<<e)-1,y=new F(32768),B=new F(d+1),C=Math.ceil(e/3),W=2*C,R=function(dr){return(r[dr]^r[dr+1]<<C^r[dr+2]<<W)&d},P=new ur(25e3),z=new F(288),m=new F(32),c=0,H=0,i=0,T=0,_=0,k=0;i<f;++i){var L=R(i),S=i&32767,U=B[L];if(y[S]=U,B[L]=S,_<=i){var w=f-i;if((c>7e3||T>24576)&&w>423){o=Kr(r,u,0,P,z,m,H,T,k,i-k,o),T=c=H=0,k=i;for(var x=0;x<286;++x)z[x]=0;for(var x=0;x<30;++x)m[x]=0}var I=2,G=0,K=M,O=S-U&32767;if(w>2&&L==R(i-O))for(var Z=Math.min(g,w)-1,b=Math.min(32767,i),D=Math.min(258,w);O<=b&&--K&&S!=U;){if(r[i+I]==r[i+I-O]){for(var A=0;A<D&&r[i+A]==r[i+A-O];++A);if(A>I){if(I=A,G=O,A>Z)break;for(var sr=Math.min(O,A-2),nr=0,x=0;x<sr;++x){var rr=i-O+x+32768&32767,ut=y[rr],Rr=rr-ut+32768&32767;Rr>nr&&(nr=Rr,U=rr)}}}S=U,U=y[S],O+=S-U+32768&32767}if(G){P[T++]=268435456|Ar[I]<<18|Wr[G];var Zr=Ar[I]&31,Nr=Wr[G]&31;H+=fr[Zr]+lr[Nr],++z[257+Zr],++m[Nr],_=i+I,++c}else P[T++]=r[i],++z[r[i]]}}o=Kr(r,u,s,P,z,m,H,T,k,i-k,o),!s&&o&7&&(o=Tr(u,o+1,Fr))}return cr(l,0,n+Dr(o)+a)};var wt=function(r,t,e,n,a){return mt(r,t.level==null?6:t.level,t.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):12+t.mem,e,n,!a)};function qr(r,t){return wt(r,t||{},0,0)}function Xr(r,t){return gt(r,t)}var br=typeof TextEncoder<"u"&&new TextEncoder,Ur=typeof TextDecoder<"u"&&new TextDecoder,xt=0;try{Ur.decode(Fr,{stream:!0}),xt=1}catch{}var dt=function(r){for(var t="",e=0;;){var n=r[e++],a=(n>127)+(n>223)+(n>239);if(e+a>r.length)return[t,cr(r,e-1)];a?a==3?(n=((n&15)<<18|(r[e++]&63)<<12|(r[e++]&63)<<6|r[e++]&63)-65536,t+=String.fromCharCode(55296|n>>10,56320|n&1023)):a&1?t+=String.fromCharCode((n&31)<<6|r[e++]&63):t+=String.fromCharCode((n&15)<<12|(r[e++]&63)<<6|r[e++]&63):t+=String.fromCharCode(n)}};function Jr(r,t){if(t){for(var e=new E(r.length),n=0;n<r.length;++n)e[n]=r.charCodeAt(n);return e}if(br)return br.encode(r);for(var a=r.length,s=new E(r.length+(r.length>>1)),f=0,l=function(i){s[f++]=i},n=0;n<a;++n){if(f+5>s.length){var u=new E(f+8+(a-n<<1));u.set(s),s=u}var o=r.charCodeAt(n);o<128||t?l(o):o<2048?(l(192|o>>6),l(128|o&63)):o>55295&&o<57344?(o=65536+(o&1023<<10)|r.charCodeAt(++n)&1023,l(240|o>>18),l(128|o>>12&63),l(128|o>>6&63),l(128|o&63)):(l(224|o>>12),l(128|o>>6&63),l(128|o&63))}return cr(s,0,f)}function Qr(r,t){if(t){for(var e="",n=0;n<r.length;n+=16384)e+=String.fromCharCode.apply(null,r.subarray(n,n+16384));return e}else{if(Ur)return Ur.decode(r);var a=dt(r),s=a[0],f=a[1];return f.length&&$(8),s}}function tr(r){return new Promise((t,e)=>{r.oncomplete=r.onsuccess=()=>t(r.result),r.onabort=r.onerror=()=>e(r.error)})}function zt(r,t){let e=indexedDB.open(r);e.onupgradeneeded=()=>e.result.createObjectStore(t);let n=tr(e);return(a,s)=>n.then(f=>s(f.transaction(t,a).objectStore(t)))}var Pr;function hr(){return Pr||(Pr=zt("keyval-store","keyval")),Pr}function vr(r,t=hr()){return t("readonly",e=>tr(e.get(r)))}function Lr(r,t,e=hr()){return e("readwrite",n=>(n.put(t,r),tr(n.transaction)))}function _r(r,t=hr()){return t("readwrite",e=>(e.delete(r),tr(e.transaction)))}function Et(r,t){return r.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},tr(r.transaction)}function rt(r=hr()){return r("readonly",t=>{if(t.getAllKeys)return tr(t.getAllKeys());let e=[];return Et(t,n=>e.push(n.key)).then(()=>e)})}var et=Symbol("Comlink.proxy"),kt=Symbol("Comlink.endpoint"),St=Symbol("Comlink.releaseProxy"),Ir=Symbol("Comlink.finalizer"),gr=Symbol("Comlink.thrown"),nt=r=>typeof r=="object"&&r!==null||typeof r=="function",At={canHandle:r=>nt(r)&&r[et],serialize(r){let{port1:t,port2:e}=new MessageChannel;return xr(r,t),[e,[e]]},deserialize(r){return r.start(),Ut(r)}},Mt={canHandle:r=>nt(r)&&gr in r,serialize({value:r}){let t;return r instanceof Error?t={isError:!0,value:{message:r.message,name:r.name,stack:r.stack}}:t={isError:!1,value:r},[t,[]]},deserialize(r){throw r.isError?Object.assign(new Error(r.value.message),r.value):r.value}},at=new Map([["proxy",At],["throw",Mt]]);function Ct(r,t){for(let e of r)if(t===e||e==="*"||e instanceof RegExp&&e.test(t))return!0;return!1}function xr(r,t=globalThis,e=["*"]){t.addEventListener("message",function n(a){if(!a||!a.data||!Ct(e,a.origin))return;let{id:s,type:f,path:l}=Object.assign({path:[]},a.data),u=(a.data.argumentList||[]).map(Q),o;try{let i=l.slice(0,-1).reduce((h,g)=>h[g],r),p=l.reduce((h,g)=>h[g],r);switch(f){case"GET":o=p;break;case"SET":i[l.slice(-1)[0]]=Q(a.data.value),o=!0;break;case"APPLY":o=p.apply(i,u);break;case"CONSTRUCT":{let h=new p(...u);o=Lt(h)}break;case"ENDPOINT":{let{port1:h,port2:g}=new MessageChannel;xr(r,g),o=Gr(h,[h])}break;case"RELEASE":o=void 0;break;default:return}}catch(i){o={value:i,[gr]:0}}Promise.resolve(o).catch(i=>({value:i,[gr]:0})).then(i=>{let[p,h]=wr(i);t.postMessage(Object.assign(Object.assign({},p),{id:s}),h),f==="RELEASE"&&(t.removeEventListener("message",n),it(t),Ir in r&&typeof r[Ir]=="function"&&r[Ir]())}).catch(i=>{let[p,h]=wr({value:new TypeError("Unserializable return value"),[gr]:0});t.postMessage(Object.assign(Object.assign({},p),{id:s}),h)})}),t.start&&t.start()}function Tt(r){return r.constructor.name==="MessagePort"}function it(r){Tt(r)&&r.close()}function Ut(r,t){return Or(r,[],t)}function pr(r){if(r)throw new Error("Proxy has been released and is not useable")}function ot(r){return er(r,{type:"RELEASE"}).then(()=>{it(r)})}var yr=new WeakMap,mr="FinalizationRegistry"in globalThis&&new FinalizationRegistry(r=>{let t=(yr.get(r)||0)-1;yr.set(r,t),t===0&&ot(r)});function Dt(r,t){let e=(yr.get(t)||0)+1;yr.set(t,e),mr&&mr.register(r,t,r)}function Ft(r){mr&&mr.unregister(r)}function Or(r,t=[],e=function(){}){let n=!1,a=new Proxy(e,{get(s,f){if(pr(n),f===St)return()=>{Ft(a),ot(r),n=!0};if(f==="then"){if(t.length===0)return{then:()=>a};let l=er(r,{type:"GET",path:t.map(u=>u.toString())}).then(Q);return l.then.bind(l)}return Or(r,[...t,f])},set(s,f,l){pr(n);let[u,o]=wr(l);return er(r,{type:"SET",path:[...t,f].map(i=>i.toString()),value:u},o).then(Q)},apply(s,f,l){pr(n);let u=t[t.length-1];if(u===kt)return er(r,{type:"ENDPOINT"}).then(Q);if(u==="bind")return Or(r,t.slice(0,-1));let[o,i]=tt(l);return er(r,{type:"APPLY",path:t.map(p=>p.toString()),argumentList:o},i).then(Q)},construct(s,f){pr(n);let[l,u]=tt(f);return er(r,{type:"CONSTRUCT",path:t.map(o=>o.toString()),argumentList:l},u).then(Q)}});return Dt(a,r),a}function Pt(r){return Array.prototype.concat.apply([],r)}function tt(r){let t=r.map(wr);return[t.map(e=>e[0]),Pt(t.map(e=>e[1]))]}var st=new WeakMap;function Gr(r,t){return st.set(r,t),r}function Lt(r){return Object.assign(r,{[et]:!0})}function wr(r){for(let[t,e]of at)if(e.canHandle(r)){let[n,a]=e.serialize(r);return[{type:"HANDLER",name:t,value:n},a]}return[{type:"RAW",value:r},st.get(r)||[]]}function Q(r){switch(r.type){case"HANDLER":return at.get(r.name).deserialize(r.value);case"RAW":return r.value}}function er(r,t,e){return new Promise(n=>{let a=It();r.addEventListener("message",function s(f){!f.data||!f.data.id||f.data.id!==a||(r.removeEventListener("message",s),n(f.data))}),r.start&&r.start(),r.postMessage(Object.assign({id:a},t),e)})}function It(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var X=!0,J=class{static successCallback(){return!0}static failureCallback(t){return!1}static compress(t){if(t===null)return null;try{let e=Jr(t);return qr(e,{level:1})}catch{return null}}static decompress(t){if(t===null)return null;try{let e=Xr(t);return Qr(e)}catch{return null}}static async save(t,e){let n=this.compress(t);return await Lr(e,n).then(this.successCallback).catch(this.failureCallback)}static async load(t,e){let n=await vr(e).catch(this.failureCallback);if(n){let a=this.decompress(n);if(a)return a;if(t>0){let s=await this.loadBackup(e);return await this.restoreBackup(e),s}return!1}return!1}static async saveExists(t){return await rt().then(function(e){return e.includes(t)})}static async restoreBackup(t){let e=t+"bak",n=await this.loadBackup(t);return await this.save(n,t),await _r(e).then(this.successCallback).catch(this.failureCallback)}static async backupSave(t){let e=t+"bak",n=await vr(t).catch(this.failureCallback);return n?await Lr(e,n).then(this.successCallback).catch(this.failureCallback):!1}static async loadBackup(t){let e=t+"bak",n=await vr(e);return this.decompress(n)}},Br=class{static compress({data:t}){let e=J.compress(t);return Gr({result:e},[e.buffer])}static decompress({data:t}){return{result:J.decompress(t)}}static async makeSave({data:t,webKey:e}){return{success:await J.save(t,e)}}static async loadSave({id:t,webKey:e}){return{result:await J.load(t,e)}}static async backupSave({webKey:t}){return{success:await J.backupSave(t)}}static async checkSaveExists({webKey:t}){return{result:await J.saveExists(t)}}};xr(Br);})();
/*! Bundled license information:

comlink/dist/esm/comlink.mjs:
  (**
   * @license
   * Copyright 2019 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   *)
*/
